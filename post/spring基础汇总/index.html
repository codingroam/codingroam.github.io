<!doctype html><html lang=zh-cn dir=zh><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=content-security-policy content="upgrade-insecure-requests"><title>Spring基础汇总 - 想学啊你</title><meta name=keywords content="博客"><meta name=author content="roam"><meta property="og:title" content="Spring基础汇总"><meta property="og:site_name" content="想学啊你"><meta property="og:image" content="https://codingroam.github.io/img/author.jpg"><meta name=title content="Spring基础汇总 - 想学啊你"><meta name=description content="spring basic"><link rel="shortcut icon" href=https://codingroam.github.io/img/favicon.ico><link rel=apple-touch-icon href=https://codingroam.github.io/img/apple-touch-icon.png><link rel=apple-touch-icon-precomposed href=https://codingroam.github.io/img/apple-touch-icon.png><link href=//unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css rel=stylesheet type=text/css><link href=//unpkg.com/imageviewer@1.1.0/dist/viewer.min.css rel=stylesheet><link href=https://codingroam.github.io/css/main.css rel=stylesheet type=text/css><link href=https://codingroam.github.io/css/syntax.css rel=stylesheet type=text/css></head><body itemscope itemtype=http://schema.org/WebPage lang=zh-Hans><div class="container one-collumn sidebar-position-left page-home"><div class=headband></div><header id=header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle role=button style=opacity:1;top:0><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><div class=custom-logo-site-title><a href=/ class=brand rel=start><span class=logo-line-before><i></i></span>
<span class=site-title>想学啊你</span>
<span class=logo-line-after><i></i></span></a></div><p class=site-subtitle>三四楼那么高了</p></div><div class=site-nav-right><div class="toggle popup-trigger" style=opacity:1;top:0><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul id=menu class=menu><li class=menu-item><a href=/ rel=section><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-active"><a href=/post rel=section><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class=menu-item><a href=/tags rel=section><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class=menu-item><a href=/categories rel=section><i class="menu-item-icon fa fa-fw fa-book"></i><br>分类</a></li><li class="menu-item menu-item-search"><a href=javascript:; class=popup-trigger><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class=site-search><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class=search-icon><i class="fa fa-search"></i></span>
<span class=popup-btn-close><i class="fa fa-times-circle"></i></span><div class=local-search-input-wrapper><input autocomplete=off placeholder=搜索关键字... spellcheck=false type=text id=local-search-input autocapitalize=none autocorrect=off></div></div><div id=local-search-result></div></div></div></nav></div></header><main id=main class=main><div class=main-inner><div class=content-wrap><div id=content class=content><section id=posts class=posts-expand><article class="post post-type-normal" itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href=https://codingroam.github.io/post/spring%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/ itemprop=url>Spring基础汇总</a></h1><div class=post-meta><span class=post-pushdate><i class="fa fa-calendar-o fa-fw"></i>
<span class=post-meta-item-text>时间：</span>
<time itemprop=dateCreated datetime=2016-03-22T13:04:35+08:00 content="2022-11-28">2022-11-28</time></span>
<span class=post-category><i class="fa fa-folder-o fa-fw"></i>
<span class=post-meta-item-text>分类：</span>
<span itemprop=about itemscope itemtype=https://schema.org/Thing><a class=post-category-a href=/categories/spring itemprop=url rel=index><span itemprop=name>Spring</span></a>
&nbsp;</span></span>
<span class=post-wordcount><i class="fa fa-file-word-o fa-fw"></i>
<span class=post-meta-item-text>字数：</span>
<span class=leancloud-world-count>21015 字</span></span>
<span class=post-readtime><i class="fa fa-eye fa-fw"></i>
<span class=post-meta-item-text>阅读：</span>
<span class=leancloud-view-count>42分钟</span></span>
<span id=/post/spring%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/ class="leancloud_visitors post-visitor" data-flag-title=Spring基础汇总><i class="fa fa-binoculars fa-fw"></i>
<span class=post-meta-item-text>阅读次数：</span>
<span class=leancloud-visitors-count></span></span></div></header><div class=post-body itemprop=articleBody><p>Spring基础汇总</p><h1 id=spring基础汇总>Spring基础汇总</h1><h2 id=1简介>1.简介</h2><h3 id=11简介>1.1.简介</h3><blockquote><p>简介</p></blockquote><p>Spring : 春天 —>给软件行业带来了春天</p><p>2002年，Rod Jahnson首次推出了Spring<a href="https://so.csdn.net/so/search?q=%e6%a1%86%e6%9e%b6&amp;spm=1001.2101.3001.7020" target=_blank rel=noopener>框架</a>
雏形interface21框架。</p><p>2004年3月24日，Spring框架以interface21框架为基础，经过重新设计，发布了1.0正式版。</p><p>很难想象Rod Johnson的学历 , 他是悉尼大学的博士，然而他的专业不是计算机，而是音乐学。</p><p>Spring理念 : 使现有技术更加实用 . 本身就是一个大杂烩 , 整合现有的框架技术</p><p>官网 : <a href=http://spring.io/ target=_blank rel=noopener>http://spring.io/</a></p><p>官方下载地址 : <a href=https://repo.spring.io/libs-release-local/org/springframework/spring/ target=_blank rel=noopener>https://repo.spring.io/libs-release-local/org/springframework/spring/</a></p><p>GitHub : <a href=https://github.com/spring-projects target=_blank rel=noopener>https://github.com/spring-projects</a></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span> https<span style=color:#666>:</span><span style=color:#080;font-style:italic>//mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#666>&lt;</span>dependency<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>&lt;</span>groupId<span style=color:#666>&gt;</span>org<span style=color:#666>.</span><span style=color:#b44>springframework</span><span style=color:#666>&lt;/</span>groupId<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>&lt;</span>artifactId<span style=color:#666>&gt;</span>spring<span style=color:#666>-</span>webmvc<span style=color:#666>&lt;/</span>artifactId<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>&lt;</span>version<span style=color:#666>&gt;</span><span style=color:#666>5.2.0</span><span style=color:#666>.</span><span style=color:#b44>RELEASE</span><span style=color:#666>&lt;/</span>version<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>dependency<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;!--</span> https<span style=color:#666>:</span><span style=color:#080;font-style:italic>//mvnrepository.com/artifact/org.springframework/spring-jdbc --&gt;
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#666>&lt;</span>dependency<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>&lt;</span>groupId<span style=color:#666>&gt;</span>org<span style=color:#666>.</span><span style=color:#b44>springframework</span><span style=color:#666>&lt;/</span>groupId<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>&lt;</span>artifactId<span style=color:#666>&gt;</span>spring<span style=color:#666>-</span>jdbc<span style=color:#666>&lt;/</span>artifactId<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>&lt;</span>version<span style=color:#666>&gt;</span><span style=color:#666>5.2.0</span><span style=color:#666>.</span><span style=color:#b44>RELEASE</span><span style=color:#666>&lt;/</span>version<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>dependency<span style=color:#666>&gt;</span>
</span></span></code></pre></div><h3 id=12优点>1.2.优点</h3><blockquote><p>优点</p></blockquote><p>1、Spring是一个开源免费的框架 , 容器 .</p><p>2、Spring是一个轻量级的框架 , 非侵入式的 .</p><p><strong>3、控制反转 IoC , 面向切面 Aop</strong></p><p>4、对事物的支持 , 对框架的支持</p><p>…</p><p>一句话概括：</p><p><strong>Spring是一个轻量级的控制反转(IoC)和面向切面(AOP)的容器（框架）。</strong></p><h3 id=13组成>1.3.组成</h3><blockquote><p>组成</p></blockquote><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613181721812.png alt=在这里插入图片描述></p><p>Spring 框架是一个分层架构，由 7 个定义良好的模块组成。Spring 模块构建在核心容器之上，核心容器定义了创建、配置和管理 bean 的方式 .</p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613181733388.png alt=在这里插入图片描述></p><p>组成 Spring 框架的每个模块（或组件）都可以单独存在，或者与其他一个或多个模块联合实现。每个模块的功能如下：</p><ul><li><strong>核心容器</strong>：核心容器提供 Spring 框架的基本功能。核心容器的主要组件是 BeanFactory，它是工厂模式的实现。BeanFactory 使用<em>控制反转</em>（IOC） 模式将应用程序的配置和依赖性规范与实际的应用程序代码分开。</li><li><strong>Spring 上下文</strong>：Spring 上下文是一个配置文件，向 Spring 框架提供上下文信息。Spring 上下文包括企业服务，例如 JNDI、EJB、电子邮件、国际化、校验和调度功能。</li><li><strong>Spring AOP</strong>：通过配置管理特性，Spring AOP 模块直接将面向切面的编程功能 , 集成到了 Spring 框架中。所以，可以很容易地使 Spring 框架管理任何支持 AOP的对象。Spring AOP 模块为基于 Spring 的应用程序中的对象提供了事务管理服务。通过使用 Spring AOP，不用依赖组件，就可以将声明性事务管理集成到应用程序中。</li><li><strong>Spring DAO</strong>：JDBC DAO 抽象层提供了有意义的异常层次结构，可用该结构来管理异常处理和不同数据库供应商抛出的错误消息。异常层次结构简化了错误处理，并且极大地降低了需要编写的异常代码数量（例如打开和关闭连接）。Spring DAO 的面向 JDBC 的异常遵从通用的 DAO 异常层次结构。</li><li><strong>Spring ORM</strong>：Spring 框架插入了若干个 ORM 框架，从而提供了 ORM 的对象关系工具，其中包括 JDO、Hibernate 和 iBatis SQL Map。所有这些都遵从 Spring 的通用事务和 DAO 异常层次结构。</li><li><strong>Spring Web 模块</strong>：Web 上下文模块建立在应用程序上下文模块之上，为基于 Web 的应用程序提供了上下文。所以，Spring 框架支持与 Jakarta Struts 的集成。Web 模块还简化了处理多部分请求以及将请求参数绑定到域对象的工作。</li><li><strong>Spring MVC 框架</strong>：MVC 框架是一个全功能的构建 Web 应用程序的 MVC 实现。通过策略接口，MVC 框架变成为高度可配置的，MVC 容纳了大量视图技术，其中包括 JSP、Velocity、Tiles、iText 和 POI。</li></ul><h3 id=14扩展>1.4.扩展</h3><blockquote><p>拓展</p></blockquote><p><strong>Spring Boot与Spring Cloud</strong></p><ul><li>Spring Boot 是 Spring 的一套快速配置脚手架，可以基于Spring Boot 快速开发单个微服务;</li><li>Spring Cloud是基于Spring Boot实现的；</li><li>Spring Boot专注于快速、方便集成的单个微服务个体，Spring Cloud关注全局的服务治理框架；</li><li>Spring Boot使用了约束优于配置的理念，很多集成方案已经帮你选择好了，能不配置就不配置 , Spring Cloud很大的一部分是基于Spring Boot来实现，Spring Boot可以离开Spring Cloud独立使用开发项目，但是Spring Cloud离不开Spring Boot，属于依赖的关系。</li><li>SpringBoot在SpringClound中起到了承上启下的作用，如果你要学习SpringCloud必须要学习SpringBoot。</li></ul><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/2020061318174078.png alt=在这里插入图片描述></p><h2 id=2ioc理论推导>2.IOC理论推导</h2><p>IoC基础</p><p>新建一个空白的maven项目</p><h3 id=21分析实现>2.1.分析实现</h3><blockquote><p>分析实现</p></blockquote><p>我们先用我们原来的方式写一段代码 .</p><p>1、先写一个UserDao接口</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>public interface UserDao {
</span></span><span style=display:flex><span>   public void getUser();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>123
</span></span></code></pre></div><p>2、再去写Dao的实现类</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserDaoImpl</span> <span style=color:#a2f;font-weight:700>implements</span> UserDao <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>getUser</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;获取用户数据&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>3、然后去写UserService的接口</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>public interface UserService {
</span></span><span style=display:flex><span>   public void getUser();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>4、最后写Service的实现类</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserServiceImpl</span> <span style=color:#a2f;font-weight:700>implements</span> UserService <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> UserDao userDao <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> UserDaoImpl<span style=color:#666>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>getUser</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       userDao<span style=color:#666>.</span><span style=color:#b44>getUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>5、测试一下</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>   UserService service <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> UserServiceImpl<span style=color:#666>();</span>
</span></span><span style=display:flex><span>   service<span style=color:#666>.</span><span style=color:#b44>getUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>这是我们原来的方式 , 开始大家也都是这么去写的对吧 . 那我们现在修改一下 .</p><p>把Userdao的实现类增加一个 .</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>public class UserDaoMySqlImpl implements UserDao {
</span></span><span style=display:flex><span>   @Override
</span></span><span style=display:flex><span>   public void getUser() {
</span></span><span style=display:flex><span>       System.out.println(&#34;MySql获取用户数据&#34;);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>123456
</span></span></code></pre></div><p>紧接着我们要去使用MySql的话 , 我们就需要去service实现类里面修改对应的实现</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserServiceImpl</span> <span style=color:#a2f;font-weight:700>implements</span> UserService <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> UserDao userDao <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> UserDaoMySqlImpl<span style=color:#666>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>getUser</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       userDao<span style=color:#666>.</span><span style=color:#b44>getUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>在假设, 我们再增加一个Userdao的实现类 .</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserDaoOracleImpl</span> <span style=color:#a2f;font-weight:700>implements</span> UserDao <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>getUser</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;Oracle获取用户数据&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>那么我们要使用Oracle , 又需要去service实现类里面修改对应的实现 . 假设我们的这种需求非常大 , 这种方式就根本不适用了, 甚至反人类对吧 , 每次变动 , 都需要修改大量代码 . 这种设计的耦合性太高了, 牵一发而动全身 .</p><p><strong>那我们如何去解决呢 ?</strong></p><p>我们可以在需要用到他的地方 , 不去实现它 , 而是留出一个接口 , 利用set , 我们去代码里修改下 .</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserServiceImpl</span> <span style=color:#a2f;font-weight:700>implements</span> UserService <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> UserDao userDao<span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic>// 利用set实现
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setUserDao</span><span style=color:#666>(</span>UserDao userDao<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>userDao</span> <span style=color:#666>=</span> userDao<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>getUser</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       userDao<span style=color:#666>.</span><span style=color:#b44>getUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>现在去我们的测试类里 , 进行测试 ;</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>   UserServiceImpl service <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> UserServiceImpl<span style=color:#666>();</span>
</span></span><span style=display:flex><span>   service<span style=color:#666>.</span><span style=color:#b44>setUserDao</span><span style=color:#666>(</span> <span style=color:#a2f;font-weight:700>new</span> UserDaoMySqlImpl<span style=color:#666>()</span> <span style=color:#666>);</span>
</span></span><span style=display:flex><span>   service<span style=color:#666>.</span><span style=color:#b44>getUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//那我们现在又想用Oracle去实现呢
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   service<span style=color:#666>.</span><span style=color:#b44>setUserDao</span><span style=color:#666>(</span> <span style=color:#a2f;font-weight:700>new</span> UserDaoOracleImpl<span style=color:#666>()</span> <span style=color:#666>);</span>
</span></span><span style=display:flex><span>   service<span style=color:#666>.</span><span style=color:#b44>getUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>大家发现了区别没有 ? 可能很多人说没啥区别 . 但是同学们 , 他们已经发生了根本性的变化 , 很多地方都不一样了 . 仔细去思考一下 , 以前所有东西都是由程序去进行控制创建 , 而现在是由我们自行控制创建对象 , 把主动权交给了调用者 . 程序不用去管怎么创建,怎么实现了 . 它只负责提供一个接口 .</p><p>这种思想 , 从本质上解决了问题 , 我们程序员不再去管理对象的创建了 , 更多的去关注业务的实现 . 耦合性大大降低 . 这也就是IOC的原型 !</p><h3 id=22ioc本质>2.2.IOC本质</h3><blockquote><p>IOC本质</p></blockquote><p><strong>控制反转IoC(Inversion of Control)，是一种设计思想，DI(依赖注入)是实现IoC的一种方法</strong>，也有人认为DI只是IoC的另一种说法。没有IoC的程序中 , 我们使用面向对象编程 , 对象的创建与对象间的依赖关系完全硬编码在程序中，对象的创建由程序自己控制，控制反转后将对象的创建转移给第三方，个人认为所谓控制反转就是：获得依赖对象的方式反转了。</p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613181806726.png alt=在这里插入图片描述>
<strong>IoC是Spring框架的核心内容</strong>，使用多种方式完美的实现了IoC，可以使用XML配置，也可以使用注解，新版本的Spring也可以零配置实现IoC。</p><p>Spring容器在初始化时先读取配置文件，根据配置文件或元数据创建与组织对象存入容器中，程序使用时再从Ioc容器中取出需要的对象。</p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613181814146.png alt=在这里插入图片描述></p><p>采用XML方式配置Bean的时候，Bean的定义信息是和实现分离的，而采用注解的方式可以把两者合为一体，Bean的定义信息直接以注解的形式定义在实现类中，从而达到了零配置的目的。</p><p><strong>控制反转是一种通过描述（XML或注解）并通过第三方去生产或获取特定对象的方式。在Spring中实现控制反转的是IoC容器，其实现方法是依赖注入（Dependency Injection,DI）。</strong></p><h2 id=3hellospring>3.HelloSpring</h2><blockquote><p>导入Jar包</p></blockquote><p>注 : spring 需要导入commons-logging进行日志记录 . 我们利用maven , 他会自动下载对应的依赖项 .</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;</span>dependency<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>groupId<span style=color:#666>&gt;</span>org<span style=color:#666>.</span><span style=color:#b44>springframework</span><span style=color:#666>&lt;/</span>groupId<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>artifactId<span style=color:#666>&gt;</span>spring<span style=color:#666>-</span>webmvc<span style=color:#666>&lt;/</span>artifactId<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>version<span style=color:#666>&gt;</span><span style=color:#666>5.1.10</span><span style=color:#666>.</span><span style=color:#b44>RELEASE</span><span style=color:#666>&lt;/</span>version<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>dependency<span style=color:#666>&gt;</span>
</span></span></code></pre></div><blockquote><p>编写代码</p></blockquote><p>1、编写一个Hello实体类</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Hello</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> String name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> String <span style=color:#00a000>getName</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setName</span><span style=color:#666>(</span>String name<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>name</span> <span style=color:#666>=</span> name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>show</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;Hello,&#34;</span><span style=color:#666>+</span> name <span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>2、编写我们的spring文件 , 这里我们命名为beans.xml</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;?</span>xml version<span style=color:#666>=</span><span style=color:#b44>&#34;1.0&#34;</span> encoding<span style=color:#666>=</span><span style=color:#b44>&#34;UTF-8&#34;</span><span style=color:#666>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>beans xmlns<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>      xmlns<span style=color:#666>:</span>xsi<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>      xsi<span style=color:#666>:</span>schemaLocation<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#b44>       http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;!--</span>bean<span>就是</span>java<span>对象</span> <span style=color:#666>,</span> <span>由</span>Spring<span>创建和管理</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;hello&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.Hello&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;name&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;Spring&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>beans<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>3、我们可以去进行测试了 .</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//解析beans.xml文件 , 生成管理相应的Bean对象
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   ApplicationContext context <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;beans.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//getBean : 参数即为spring配置文件中bean的id .
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   Hello hello <span style=color:#666>=</span> <span style=color:#666>(</span>Hello<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;hello&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   hello<span style=color:#666>.</span><span style=color:#b44>show</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><blockquote><p>思考</p></blockquote><ul><li>Hello 对象是谁创建的 ? hello 对象是由Spring创建的</li><li>Hello 对象的属性是怎么设置的 ? hello 对象的属性是由Spring容器设置的</li></ul><p>这个过程就叫控制反转 :</p><ul><li>控制 : 谁来控制对象的创建 , 传统应用程序的对象是由程序本身控制创建的 , 使用Spring后 , 对象是由Spring来创建的</li><li>反转 : 程序本身不创建对象 , 而变成被动的接收对象 .</li></ul><p>依赖注入 : 就是利用set方法来进行注入的.</p><p>IOC是一种编程思想，由主动的编程变成被动的接收</p><p>可以通过newClassPathXmlApplicationContext去浏览一下底层源码 .</p><blockquote><p>修改案例一</p></blockquote><p>我们在案例一中， 新增一个Spring配置文件beans.xml</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;?</span>xml version<span style=color:#666>=</span><span style=color:#b44>&#34;1.0&#34;</span> encoding<span style=color:#666>=</span><span style=color:#b44>&#34;UTF-8&#34;</span><span style=color:#666>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>beans xmlns<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>      xmlns<span style=color:#666>:</span>xsi<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>      xsi<span style=color:#666>:</span>schemaLocation<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#b44>       http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;MysqlImpl&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.dao.impl.UserDaoMySqlImpl&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;OracleImpl&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.dao.impl.UserDaoOracleImpl&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;ServiceImpl&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.service.impl.UserServiceImpl&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;!--</span><span>注意</span><span style=color:#666>:</span> <span>这里的</span>name<span>并不是属性</span> <span style=color:#666>,</span> <span>而是</span>set<span>方法后面的那部分</span> <span style=color:#666>,</span> <span>首字母小写</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;!--</span><span>引用另外一个</span>bean <span style=color:#666>,</span> <span>不是用</span>value <span>而是用</span> ref<span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;userDao&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;OracleImpl&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>beans<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>测试！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>@Test
</span></span><span style=display:flex><span>public void test2(){
</span></span><span style=display:flex><span>   ApplicationContext context = new ClassPathXmlApplicationContext(&#34;beans.xml&#34;);
</span></span><span style=display:flex><span>   UserServiceImpl serviceImpl = (UserServiceImpl) context.getBean(&#34;ServiceImpl&#34;);
</span></span><span style=display:flex><span>   serviceImpl.getUser();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>123456
</span></span></code></pre></div><p>OK , 到了现在 , 我们彻底不用再程序中去改动了 , 要实现不同的操作 , 只需要在xml配置文件中进行修改 , 所谓的IoC,一句话搞定 : 对象由Spring 来创建 , 管理 , 装配 !</p><h2 id=4ioc创建对象方式>4.IOC创建对象方式</h2><h3 id=41通过无参构造方法来创建>4.1.通过无参构造方法来创建</h3><blockquote><p>通过无参构造方法来创建</p></blockquote><p>1、User.java</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>public class User {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   private String name;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   public User() {
</span></span><span style=display:flex><span>       System.out.println(&#34;user无参构造方法&#34;);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   public void setName(String name) {
</span></span><span style=display:flex><span>       this.name = name;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   public void show(){
</span></span><span style=display:flex><span>       System.out.println(&#34;name=&#34;+ name );
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>1234567891011121314151617
</span></span></code></pre></div><p>2、beans.xml</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;?</span>xml version<span style=color:#666>=</span><span style=color:#b44>&#34;1.0&#34;</span> encoding<span style=color:#666>=</span><span style=color:#b44>&#34;UTF-8&#34;</span><span style=color:#666>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>beans xmlns<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>      xmlns<span style=color:#666>:</span>xsi<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>      xsi<span style=color:#666>:</span>schemaLocation<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#b44>       http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;user&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.User&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;name&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;kuangshen&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>beans<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>3、测试类</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>   ApplicationContext context <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;beans.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//在执行getBean的时候, user已经创建好了 , 通过无参构造
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   User user <span style=color:#666>=</span> <span style=color:#666>(</span>User<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;user&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//调用对象的方法 .
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   user<span style=color:#666>.</span><span style=color:#b44>show</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>结果可以发现，在调用show方法之前，User对象已经通过无参构造初始化了！</p><h3 id=42通过有参构造方法来创建>4.2.通过有参构造方法来创建</h3><blockquote><p>通过有参构造方法来创建</p></blockquote><p>1、UserT . java</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserT</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> String name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#00a000>UserT</span><span style=color:#666>(</span>String name<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>name</span> <span style=color:#666>=</span> name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setName</span><span style=color:#666>(</span>String name<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>name</span> <span style=color:#666>=</span> name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>show</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;name=&#34;</span><span style=color:#666>+</span> name <span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>2、beans.xml 有三种方式编写</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span> <span>第一种根据</span>index<span>参数下标设置</span> <span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;userT&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.UserT&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;!--</span> index<span>指构造方法</span> <span style=color:#666>,</span> <span>下标从</span><span style=color:#666>0</span><span>开始</span> <span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>constructor<span style=color:#666>-</span>arg index<span style=color:#666>=</span><span style=color:#b44>&#34;0&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;kuangshen2&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;!--</span> <span>第二种根据参数名字设置</span> <span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;userT&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.UserT&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;!--</span> name<span>指参数名</span> <span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>constructor<span style=color:#666>-</span>arg name<span style=color:#666>=</span><span style=color:#b44>&#34;name&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;kuangshen2&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;!--</span> <span>第三种根据参数类型设置</span> <span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;userT&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.UserT&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>constructor<span style=color:#666>-</span>arg type<span style=color:#666>=</span><span style=color:#b44>&#34;java.lang.String&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;kuangshen2&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>3、测试</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>@Test
</span></span><span style=display:flex><span>public void testT(){
</span></span><span style=display:flex><span>   ApplicationContext context = new ClassPathXmlApplicationContext(&#34;beans.xml&#34;);
</span></span><span style=display:flex><span>   UserT user = (UserT) context.getBean(&#34;userT&#34;);
</span></span><span style=display:flex><span>   user.show();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>123456
</span></span></code></pre></div><p>结论：在配置文件加载的时候。其中管理的对象都已经初始化了！</p><h2 id=5spring配置>5.Spring配置</h2><h3 id=51别名>5.1.别名</h3><blockquote><p>别名</p></blockquote><p>alias 设置别名 , 为bean设置别名 , 可以设置多个别名</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span><span>设置别名：在获取</span>Bean<span>的时候可以使用别名获取</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>alias name<span style=color:#666>=</span><span style=color:#b44>&#34;userT&#34;</span> alias<span style=color:#666>=</span><span style=color:#b44>&#34;userNew&#34;</span><span style=color:#666>/&gt;</span>
</span></span></code></pre></div><h3 id=52bean的配置>5.2.Bean的配置</h3><blockquote><p>Bean的配置</p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span>bean<span>就是</span>java<span>对象</span><span style=color:#666>,</span><span>由</span>Spring<span>创建和管理</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;!--</span>
</span></span><span style=display:flex><span>   id <span>是</span>bean<span>的标识符</span><span style=color:#666>,</span><span>要唯一</span><span style=color:#666>,</span><span>如果没有配置</span>id<span style=color:#666>,</span>name<span>就是默认标识符</span>
</span></span><span style=display:flex><span>   <span>如果配置</span>id<span style=color:#666>,</span><span>又配置了</span>name<span style=color:#666>,</span><span>那么</span>name<span>是别名</span>
</span></span><span style=display:flex><span>   name<span>可以设置多个别名</span><span style=color:#666>,</span><span>可以用逗号</span><span style=color:#666>,</span><span>分号</span><span style=color:#666>,</span><span>空格隔开</span>
</span></span><span style=display:flex><span>   <span>如果不配置</span>id<span>和</span>name<span style=color:#666>,</span><span>可以根据</span>applicationContext<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(.</span><span style=color:#b44>class</span><span style=color:#666>)</span><span>获取对象</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>class<span>是</span>bean<span>的全限定名</span><span style=color:#666>=</span><span>包名</span><span style=color:#666>+</span><span>类名</span>
</span></span><span style=display:flex><span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;hello&#34;</span> name<span style=color:#666>=</span><span style=color:#b44>&#34;hello2 h2,h3;h4&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.Hello&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;name&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;Spring&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><h3 id=53import>5.3.import</h3><blockquote><p>import</p></blockquote><p>团队的合作通过import来实现 .</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;import resource=&#34;{path}/beans.xml&#34;/&gt;
</span></span><span style=display:flex><span>1
</span></span></code></pre></div><h2 id=6依赖注入di>6.依赖注入（DI）</h2><p>Dependency Injection</p><blockquote><p>概念</p></blockquote><ul><li>依赖注入（Dependency Injection,DI）。</li><li>依赖 : 指Bean对象的创建依赖于容器 . Bean对象的依赖资源 .</li><li>注入 : 指Bean对象所依赖的资源 , 由容器来设置和装配 .</li></ul><h3 id=61构造器注入>6.1.构造器注入</h3><blockquote><p>构造器注入</p></blockquote><p>我们在之前的案例已经讲过了</p><h3 id=62set-注入-重点>6.2.Set 注入 （重点）</h3><blockquote><p>Set 注入 （重点）</p></blockquote><p>要求被注入的属性 , 必须有set方法 , set方法的方法名由set + 属性首字母大写 , 如果属性是boolean类型 , 没有set方法 , 是 is .</p><p>测试pojo类 :</p><p>Address.java</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Address</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>private</span> String address<span style=color:#666>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> String <span style=color:#00a000>getAddress</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>return</span> address<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setAddress</span><span style=color:#666>(</span>String address<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>address</span> <span style=color:#666>=</span> address<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> <span style=color:#666>}</span>
</span></span></code></pre></div><p>Student.java</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#a2f;font-weight:700>package</span> <span style=color:#00f;font-weight:700>com.kuang.pojo</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> <span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.util.List</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span> <span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.util.Map</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span> <span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.util.Properties</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span> <span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.util.Set</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> <span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Student</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>private</span> String name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>private</span> Address address<span style=color:#666>;</span>
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>private</span> String<span style=color:#666>[]</span> books<span style=color:#666>;</span>
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>private</span> List<span style=color:#666>&lt;</span>String<span style=color:#666>&gt;</span> hobbys<span style=color:#666>;</span>
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>private</span> Map<span style=color:#666>&lt;</span>String<span style=color:#666>,</span>String<span style=color:#666>&gt;</span> card<span style=color:#666>;</span>
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>private</span> Set<span style=color:#666>&lt;</span>String<span style=color:#666>&gt;</span> games<span style=color:#666>;</span>
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>private</span> String wife<span style=color:#666>;</span>
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>private</span> Properties info<span style=color:#666>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setName</span><span style=color:#666>(</span>String name<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>name</span> <span style=color:#666>=</span> name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setAddress</span><span style=color:#666>(</span>Address address<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>address</span> <span style=color:#666>=</span> address<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setBooks</span><span style=color:#666>(</span>String<span style=color:#666>[]</span> books<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>books</span> <span style=color:#666>=</span> books<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setHobbys</span><span style=color:#666>(</span>List<span style=color:#666>&lt;</span>String<span style=color:#666>&gt;</span> hobbys<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>hobbys</span> <span style=color:#666>=</span> hobbys<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setCard</span><span style=color:#666>(</span>Map<span style=color:#666>&lt;</span>String<span style=color:#666>,</span> String<span style=color:#666>&gt;</span> card<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>card</span> <span style=color:#666>=</span> card<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setGames</span><span style=color:#666>(</span>Set<span style=color:#666>&lt;</span>String<span style=color:#666>&gt;</span> games<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>games</span> <span style=color:#666>=</span> games<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setWife</span><span style=color:#666>(</span>String wife<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>wife</span> <span style=color:#666>=</span> wife<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setInfo</span><span style=color:#666>(</span>Properties info<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>info</span> <span style=color:#666>=</span> info<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>show</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>         System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;name=&#34;</span><span style=color:#666>+</span> name
</span></span><span style=display:flex><span>                 <span style=color:#666>+</span> <span style=color:#b44>&#34;,address=&#34;</span><span style=color:#666>+</span> address<span style=color:#666>.</span><span style=color:#b44>getAddress</span><span style=color:#666>()</span>
</span></span><span style=display:flex><span>                 <span style=color:#666>+</span> <span style=color:#b44>&#34;,books=&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#666>);</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>for</span> <span style=color:#666>(</span>String book<span style=color:#666>:</span>books<span style=color:#666>){</span>
</span></span><span style=display:flex><span>             System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>print</span><span style=color:#666>(</span><span style=color:#b44>&#34;&lt;&lt;&#34;</span><span style=color:#666>+</span>book<span style=color:#666>+</span><span style=color:#b44>&#34;&gt;&gt;\t&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>        <span style=color:#666>}</span>
</span></span><span style=display:flex><span>         System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;\n爱好:&#34;</span><span style=color:#666>+</span>hobbys<span style=color:#666>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>         System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;card:&#34;</span><span style=color:#666>+</span>card<span style=color:#666>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>         System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;games:&#34;</span><span style=color:#666>+</span>games<span style=color:#666>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>         System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;wife:&#34;</span><span style=color:#666>+</span>wife<span style=color:#666>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>         System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;info:&#34;</span><span style=color:#666>+</span>info<span style=color:#666>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> <span style=color:#666>}</span>
</span></span></code></pre></div><h3 id=63扩展的注入>6.3.扩展的注入</h3><p>1、<strong>常量注入</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;student&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.Student&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;name&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;小明&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>测试：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span> <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test01</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>     ApplicationContext context <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;applicationContext.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     Student student <span style=color:#666>=</span> <span style=color:#666>(</span>Student<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;student&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>student<span style=color:#666>.</span><span style=color:#b44>getName</span><span style=color:#666>());</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> <span style=color:#666>}</span>
</span></span></code></pre></div><p>2、<strong>Bean注入</strong></p><p>注意点：这里的值是一个引用，ref</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;addr&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.Address&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;address&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;重庆&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;student&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.Student&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;name&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;小明&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;address&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;addr&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>3、<strong>数组注入</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;student&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.Student&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;name&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;小明&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;address&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;addr&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;books&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>array<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>             <span style=color:#666>&lt;</span>value<span style=color:#666>&gt;</span><span>西游记</span><span style=color:#666>&lt;/</span>value<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>             <span style=color:#666>&lt;</span>value<span style=color:#666>&gt;</span><span>红楼梦</span><span style=color:#666>&lt;/</span>value<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>             <span style=color:#666>&lt;</span>value<span style=color:#666>&gt;</span><span>水浒传</span><span style=color:#666>&lt;/</span>value<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;/</span>array<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;/</span>property<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>4、<strong>List注入</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;hobbys&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;</span>list<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>value<span style=color:#666>&gt;</span><span>听歌</span><span style=color:#666>&lt;/</span>value<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>value<span style=color:#666>&gt;</span><span>看电影</span><span style=color:#666>&lt;/</span>value<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>value<span style=color:#666>&gt;</span><span>爬山</span><span style=color:#666>&lt;/</span>value<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;/</span>list<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;/</span>property<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>5、<strong>Map注入</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;card&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;</span>map<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>entry key<span style=color:#666>=</span><span style=color:#b44>&#34;中国邮政&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;456456456465456&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>entry key<span style=color:#666>=</span><span style=color:#b44>&#34;建设&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;1456682255511&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;/</span>map<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;/</span>property<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>6、<strong>set注入</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;games&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;</span>set<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>value<span style=color:#666>&gt;</span>LOL<span style=color:#666>&lt;/</span>value<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>value<span style=color:#666>&gt;</span>BOB<span style=color:#666>&lt;/</span>value<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>value<span style=color:#666>&gt;</span>COC<span style=color:#666>&lt;/</span>value<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;/</span>set<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;/</span>property<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>7、<strong>Null注入</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;wife&#34;</span><span style=color:#666>&gt;&lt;</span><span style=color:#a2f;font-weight:700>null</span><span style=color:#666>/&gt;&lt;/</span>property<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>8、<strong>Properties注入</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;info&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;</span>props<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>prop key<span style=color:#666>=</span><span style=color:#b44>&#34;学号&#34;</span><span style=color:#666>&gt;</span><span style=color:#666>20190604</span><span style=color:#666>&lt;/</span>prop<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>prop key<span style=color:#666>=</span><span style=color:#b44>&#34;性别&#34;</span><span style=color:#666>&gt;</span><span>男</span><span style=color:#666>&lt;/</span>prop<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#666>&lt;</span>prop key<span style=color:#666>=</span><span style=color:#b44>&#34;姓名&#34;</span><span style=color:#666>&gt;</span><span>小明</span><span style=color:#666>&lt;/</span>prop<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#666>&lt;/</span>props<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;/</span>property<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>测试结果：
<img src=https://img-blog.csdnimg.cn/20200613181945474.png alt=在这里插入图片描述></p><p>9、p命名和c命名注入</p><blockquote><p>p命名和c命名注入</p></blockquote><p>User.java ：【注意：这里没有有参构造器！】</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>User</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>private</span> String name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>private</span> <span style=color:#0b0;font-weight:700>int</span> age<span style=color:#666>;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setName</span><span style=color:#666>(</span>String name<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>name</span> <span style=color:#666>=</span> name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setAge</span><span style=color:#666>(</span><span style=color:#0b0;font-weight:700>int</span> age<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>age</span> <span style=color:#666>=</span> age<span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>     <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>     <span style=color:#a2f;font-weight:700>public</span> String <span style=color:#00a000>toString</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>         <span style=color:#a2f;font-weight:700>return</span> <span style=color:#b44>&#34;User{&#34;</span> <span style=color:#666>+</span>
</span></span><span style=display:flex><span>                 <span style=color:#b44>&#34;name=&#39;&#34;</span> <span style=color:#666>+</span> name <span style=color:#666>+</span> <span style=color:#b44>&#39;\&#39;&#39;</span> <span style=color:#666>+</span>
</span></span><span style=display:flex><span>                 <span style=color:#b44>&#34;, age=&#34;</span> <span style=color:#666>+</span> age <span style=color:#666>+</span>
</span></span><span style=display:flex><span>                 <span style=color:#b44>&#39;}&#39;</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span>    <span style=color:#666>}</span>
</span></span><span style=display:flex><span> <span style=color:#666>}</span>
</span></span></code></pre></div><p>1、P命名空间注入 : 需要在头文件中加入约束文件</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span>导入约束</span> <span style=color:#666>:</span> xmlns<span style=color:#666>:</span>p<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/p&#34;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> <span style=color:#666>&lt;!--</span>P<span style=color:#666>(</span><span>属性</span><span style=color:#666>:</span> properties<span style=color:#666>)</span><span>命名空间</span> <span style=color:#666>,</span> <span>直接注入属性</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;user&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.User&#34;</span> p<span style=color:#666>:</span>name<span style=color:#666>=</span><span style=color:#b44>&#34;狂神&#34;</span> p<span style=color:#666>:</span>age<span style=color:#666>=</span><span style=color:#b44>&#34;18&#34;</span><span style=color:#666>/&gt;</span>
</span></span></code></pre></div><p>2、c 命名空间注入 : 需要在头文件中加入约束文件</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span>导入约束</span> <span style=color:#666>:</span> xmlns<span style=color:#666>:</span>c<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/c&#34;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;!--</span>C<span style=color:#666>(</span><span>构造</span><span style=color:#666>:</span> Constructor<span style=color:#666>)</span><span>命名空间</span> <span style=color:#666>,</span> <span>使用构造器注入</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;user&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.User&#34;</span> c<span style=color:#666>:</span>name<span style=color:#666>=</span><span style=color:#b44>&#34;狂神&#34;</span> c<span style=color:#666>:</span>age<span style=color:#666>=</span><span style=color:#b44>&#34;18&#34;</span><span style=color:#666>/&gt;</span>
</span></span></code></pre></div><p>发现问题：爆红了，刚才我们没有写有参构造！</p><p>解决：把有参构造器加上，这里也能知道，c 就是所谓的构造器注入！</p><p>测试代码：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span> <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test02</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>     ApplicationContext context <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;applicationContext.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>     User user <span style=color:#666>=</span> <span style=color:#666>(</span>User<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;user&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>     System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>user<span style=color:#666>);</span>
</span></span><span style=display:flex><span> <span style=color:#666>}</span>
</span></span></code></pre></div><h3 id=64bean的作用域>6.4.Bean的作用域</h3><blockquote><p>Bean的作用域</p></blockquote><p>在Spring中，那些组成应用程序的主体及由Spring IoC容器所管理的对象，被称之为bean。简单地讲，bean就是由IoC容器初始化、装配及管理的对象 .
<img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613181958988.png alt=在这里插入图片描述></p><p>几种作用域中，request、session作用域仅在基于web的应用中使用（不必关心你所采用的是什么web应用框架），只能用在基于web的Spring ApplicationContext环境。</p><h4 id=singleton单例模式>Singleton(单例模式)</h4><p>当一个bean的作用域为Singleton，那么Spring IoC容器中只会存在一个共享的bean实例，并且所有对bean的请求，只要id与该bean定义相匹配，则只会返回bean的同一实例。Singleton是单例类型，就是在创建起容器时就同时自动创建了一个bean的对象，不管你是否使用，他都存在了，每次获取到的对象都是同一个对象。注意，Singleton作用域是Spring中的缺省作用域。要在XML中将bean定义成singleton，可以这样配置：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;ServiceImpl&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;cn.csdn.service.ServiceImpl&#34;</span> scope<span style=color:#666>=</span><span style=color:#b44>&#34;singleton&#34;</span><span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>测试：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span> <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test03</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>     ApplicationContext context <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;applicationContext.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>     User user <span style=color:#666>=</span> <span style=color:#666>(</span>User<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;user&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>     User user2 <span style=color:#666>=</span> <span style=color:#666>(</span>User<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;user&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>     System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>user<span style=color:#666>==</span>user2<span style=color:#666>);</span>
</span></span><span style=display:flex><span> <span style=color:#666>}</span>
</span></span></code></pre></div><h4 id=prototype原型模式>Prototype(原型模式)</h4><p>当一个bean的作用域为Prototype，表示一个bean定义对应多个对象实例。Prototype作用域的bean会导致在每次对该bean请求（将其注入到另一个bean中，或者以程序的方式调用容器的getBean()方法）时都会创建一个新的bean实例。Prototype是原型类型，它在我们创建容器的时候并没有实例化，而是当我们获取bean的时候才会去创建一个对象，而且我们每次获取到的对象都不是同一个对象。根据经验，对有状态的bean应该使用prototype作用域，而对无状态的bean则应该使用singleton作用域。在XML中将bean定义成prototype，可以这样配置：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;account&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.foo.DefaultAccount&#34;</span> scope<span style=color:#666>=</span><span style=color:#b44>&#34;prototype&#34;</span><span style=color:#666>/&gt;</span>  
</span></span><span style=display:flex><span>  <span>或者</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;account&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.foo.DefaultAccount&#34;</span> singleton<span style=color:#666>=</span><span style=color:#b44>&#34;false&#34;</span><span style=color:#666>/&gt;</span>
</span></span></code></pre></div><h4 id=request>Request</h4><p>当一个bean的作用域为Request，表示在一次HTTP请求中，一个bean定义对应一个实例；即每个HTTP请求都会有各自的bean实例，它们依据某个bean定义创建而成。该作用域仅在基于web的Spring ApplicationContext情形下有效。考虑下面bean定义：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span> &lt;bean id=&#34;loginAction&#34; class=cn.csdn.LoginAction&#34; scope=&#34;request&#34;/&gt;
</span></span><span style=display:flex><span>1
</span></span></code></pre></div><p>针对每次HTTP请求，Spring容器会根据loginAction bean的定义创建一个全新的LoginAction bean实例，且该loginAction bean实例仅在当前HTTP request内有效，因此可以根据需要放心的更改所建实例的内部状态，而其他请求中根据loginAction bean定义创建的实例，将不会看到这些特定于某个请求的状态变化。当处理请求结束，request作用域的bean实例将被销毁。</p><h4 id=session>Session</h4><p>当一个bean的作用域为Session，表示在一个HTTP Session中，一个bean定义对应一个实例。该作用域仅在基于web的Spring ApplicationContext情形下有效。考虑下面bean定义：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span> &lt;bean id=&#34;userPreferences&#34; class=&#34;com.foo.UserPreferences&#34; scope=&#34;session&#34;/&gt;
</span></span><span style=display:flex><span>1
</span></span></code></pre></div><p>针对某个HTTP Session，Spring容器会根据userPreferences bean定义创建一个全新的userPreferences bean实例，且该userPreferences bean仅在当前HTTP Session内有效。与request作用域一样，可以根据需要放心的更改所创建实例的内部状态，而别的HTTP Session中根据userPreferences创建的实例，将不会看到这些特定于某个HTTP Session的状态变化。当HTTP Session最终被废弃的时候，在该HTTP Session作用域内的bean也会被废弃掉。</p><h2 id=7bean的自动装配>7.Bean的自动装配</h2><blockquote><p>自动装配说明</p></blockquote><ul><li>自动装配是使用spring满足bean依赖的一种方法</li><li>spring会在应用上下文中为某个bean寻找其依赖的bean。</li></ul><p>Spring中bean有三种装配机制，分别是：</p><ol><li>在xml中显式配置；</li><li>在java中显式配置；</li><li>隐式的bean发现机制和自动装配。</li></ol><p>这里我们主要讲第三种：自动化的装配bean。</p><p>Spring的自动装配需要从两个角度来实现，或者说是两个操作：</p><ol><li>组件扫描(component scanning)：spring会自动发现应用上下文中所创建的bean；</li><li>自动装配(autowiring)：spring自动满足bean之间的依赖，也就是我们说的IoC/DI；</li></ol><p>组件扫描和自动装配组合发挥巨大威力，使得显示的配置降低到最少。</p><p><strong>推荐不使用自动装配xml配置 , 而使用注解 .</strong></p><p>**
**</p><blockquote><p>测试环境搭建</p></blockquote><p>1、新建一个项目</p><p>2、新建两个实体类，Cat Dog 都有一个叫的方法</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Cat</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>shout</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;miao~&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Dog</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>shout</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;wang~&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>3、新建一个用户类 User</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>User</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> Cat cat<span style=color:#666>;</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> Dog dog<span style=color:#666>;</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> String str<span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>4、编写Spring配置文件</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;?</span>xml version<span style=color:#666>=</span><span style=color:#b44>&#34;1.0&#34;</span> encoding<span style=color:#666>=</span><span style=color:#b44>&#34;UTF-8&#34;</span><span style=color:#666>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>beans xmlns<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>      xmlns<span style=color:#666>:</span>xsi<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>      xsi<span style=color:#666>:</span>schemaLocation<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#b44>       http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;dog&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.Dog&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;cat&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.Cat&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;user&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.User&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;cat&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;cat&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;dog&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;dog&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;str&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;qinjiang&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>beans<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>5、测试</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>MyTest</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>testMethodAutowire</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       ApplicationContext context <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;beans.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       User user <span style=color:#666>=</span> <span style=color:#666>(</span>User<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;user&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       user<span style=color:#666>.</span><span style=color:#b44>getCat</span><span style=color:#666>().</span><span style=color:#b44>shout</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>       user<span style=color:#666>.</span><span style=color:#b44>getDog</span><span style=color:#666>().</span><span style=color:#b44>shout</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>结果正常输出，环境OK</p><h3 id=71byname>7.1.byName</h3><blockquote><p>byName</p></blockquote><p><strong>autowire byName (按名称自动装配)</strong></p><p>由于在手动配置xml过程中，常常发生字母缺漏和大小写等错误，而无法对其进行检查，使得开发效率降低。</p><p>采用自动装配将避免这些错误，并且使配置简单化。</p><p>测试：</p><p>1、修改bean配置，增加一个属性 autowire=“byName”</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;user&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.User&#34;</span> autowire<span style=color:#666>=</span><span style=color:#b44>&#34;byName&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;str&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;qinjiang&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>2、再次测试，结果依旧成功输出！</p><p>3、我们将 cat 的bean id修改为 catXXX</p><p>4、再次测试， 执行时报空指针java.lang.NullPointerException。因为按byName规则找不对应set方法，真正的setCat就没执行，对象就没有初始化，所以调用时就会报空指针错误。</p><p><strong>小结：</strong></p><p>当一个bean节点带有 autowire byName的属性时。</p><ol><li>将查找其类中所有的set方法名，例如setCat，获得将set去掉并且首字母小写的字符串，即cat。</li><li>去spring容器中寻找是否有此字符串名称id的对象。</li><li>如果有，就取出注入；如果没有，就报空指针异常。</li></ol><h3 id=72bytype>7.2.byType</h3><blockquote><p>byType</p></blockquote><p><strong>autowire byType (按类型自动装配)</strong></p><p>使用autowire byType首先需要保证：同一类型的对象，在spring容器中唯一。如果不唯一，会报不唯一的异常。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>NoUniqueBeanDefinitionException
</span></span></code></pre></div><p>测试：</p><p>1、将user的bean配置修改一下 ： autowire=“byType”</p><p>2、测试，正常输出</p><p>3、在注册一个cat 的bean对象！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;bean id=&#34;dog&#34; class=&#34;com.kuang.pojo.Dog&#34;/&gt;
</span></span><span style=display:flex><span>&lt;bean id=&#34;cat&#34; class=&#34;com.kuang.pojo.Cat&#34;/&gt;
</span></span><span style=display:flex><span>&lt;bean id=&#34;cat2&#34; class=&#34;com.kuang.pojo.Cat&#34;/&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;bean id=&#34;user&#34; class=&#34;com.kuang.pojo.User&#34; autowire=&#34;byType&#34;&gt;
</span></span><span style=display:flex><span>   &lt;property name=&#34;str&#34; value=&#34;qinjiang&#34;/&gt;
</span></span><span style=display:flex><span>&lt;/bean&gt;
</span></span><span style=display:flex><span>1234567
</span></span></code></pre></div><p>4、测试，报错：NoUniqueBeanDefinitionException</p><p>5、删掉cat2，将cat的bean名称改掉！测试！因为是按类型装配，所以并不会报异常，也不影响最后的结果。甚至将id属性去掉，也不影响结果。</p><p>这就是按照类型自动装配！</p><h3 id=73使用注解>7.3.使用注解</h3><blockquote><p>使用注解</p></blockquote><p>jdk1.5开始支持注解，spring2.5开始全面支持注解。</p><p>准备工作：利用注解的方式注入属性。</p><p>1、在spring配置文件中引入context文件头</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>xmlns:context=&#34;http://www.springframework.org/schema/context&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>http://www.springframework.org/schema/context
</span></span><span style=display:flex><span>http://www.springframework.org/schema/context/spring-context.xsd
</span></span></code></pre></div><p>2、开启属性注解支持！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;context:annotation-config/&gt;
</span></span></code></pre></div><h4 id=autowired>@Autowired</h4><ul><li>@Autowired是按类型自动转配的，不支持id匹配。</li><li>需要导入 spring-aop的包！</li></ul><p>测试：</p><p>1、将User类中的set方法去掉，使用@Autowired注解</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>User</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Autowired</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> Cat cat<span style=color:#666>;</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Autowired</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> Dog dog<span style=color:#666>;</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> String str<span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> Cat <span style=color:#00a000>getCat</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> cat<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> Dog <span style=color:#00a000>getDog</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> dog<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> String <span style=color:#00a000>getStr</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> str<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>2、此时配置文件内容</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;context:annotation-config/&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;bean id=&#34;dog&#34; class=&#34;com.kuang.pojo.Dog&#34;/&gt;
</span></span><span style=display:flex><span>&lt;bean id=&#34;cat&#34; class=&#34;com.kuang.pojo.Cat&#34;/&gt;
</span></span><span style=display:flex><span>&lt;bean id=&#34;user&#34; class=&#34;com.kuang.pojo.User&#34;/&gt;
</span></span></code></pre></div><p>3、测试，成功输出结果！</p><p>【小狂神科普时间】</p><p>@Autowired(required=false) 说明：false，对象可以为null；true，对象必须存对象，不能为null。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#080;font-style:italic>//如果允许对象为null，设置required = false,默认为true
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f>@Autowired</span><span style=color:#666>(</span>required <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>false</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>private</span> Cat cat<span style=color:#666>;</span>
</span></span></code></pre></div><h4 id=qualifier>@Qualifier</h4><ul><li>@Autowired是根据类型自动装配的，加上@Qualifier则可以根据byName的方式自动装配</li><li>@Qualifier不能单独使用。</li></ul><p>测试实验步骤：</p><p>1、配置文件修改内容，保证类型存在对象。且名字不为类的默认名字！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;bean id=&#34;dog1&#34; class=&#34;com.kuang.pojo.Dog&#34;/&gt;
</span></span><span style=display:flex><span>&lt;bean id=&#34;dog2&#34; class=&#34;com.kuang.pojo.Dog&#34;/&gt;
</span></span><span style=display:flex><span>&lt;bean id=&#34;cat1&#34; class=&#34;com.kuang.pojo.Cat&#34;/&gt;
</span></span><span style=display:flex><span>&lt;bean id=&#34;cat2&#34; class=&#34;com.kuang.pojo.Cat&#34;/&gt;
</span></span></code></pre></div><p>2、没有加Qualifier测试，直接报错</p><p>3、在属性上添加Qualifier注解</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>@Autowired
</span></span><span style=display:flex><span>@Qualifier(value = &#34;cat2&#34;)
</span></span><span style=display:flex><span>private Cat cat;
</span></span><span style=display:flex><span>@Autowired
</span></span><span style=display:flex><span>@Qualifier(value = &#34;dog2&#34;)
</span></span><span style=display:flex><span>private Dog dog;
</span></span></code></pre></div><p>测试，成功输出！</p><h4 id=resource>@Resource</h4><ul><li>@Resource如有指定的name属性，先按该属性进行byName方式查找装配；</li><li>其次再进行默认的byName方式进行装配；</li><li>如果以上都不成功，则按byType的方式自动装配。</li><li>都不成功，则报异常。</li></ul><p>实体类：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>User</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//如果允许对象为null，设置required = false,默认为true
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f>@Resource</span><span style=color:#666>(</span>name <span style=color:#666>=</span> <span style=color:#b44>&#34;cat2&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> Cat cat<span style=color:#666>;</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Resource</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> Dog dog<span style=color:#666>;</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> String str<span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>beans.xml</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;bean id=&#34;dog&#34; class=&#34;com.kuang.pojo.Dog&#34;/&gt;
</span></span><span style=display:flex><span>&lt;bean id=&#34;cat1&#34; class=&#34;com.kuang.pojo.Cat&#34;/&gt;
</span></span><span style=display:flex><span>&lt;bean id=&#34;cat2&#34; class=&#34;com.kuang.pojo.Cat&#34;/&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;bean id=&#34;user&#34; class=&#34;com.kuang.pojo.User&#34;/&gt;
</span></span></code></pre></div><p>测试：结果OK</p><p>配置文件2：beans.xml ， 删掉cat2</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;bean id=&#34;dog&#34; class=&#34;com.kuang.pojo.Dog&#34;/&gt;
</span></span><span style=display:flex><span>&lt;bean id=&#34;cat1&#34; class=&#34;com.kuang.pojo.Cat&#34;/&gt;
</span></span></code></pre></div><p>实体类上只保留注解</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Resource</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>private</span> Cat cat<span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#a2f>@Resource</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>private</span> Dog dog<span style=color:#666>;</span>
</span></span></code></pre></div><p>结果：OK</p><p>结论：先进行byName查找，失败；再进行byType查找，成功。</p><p>小结</p><p>@Autowired与@Resource异同：</p><p>1、@Autowired与@Resource都可以用来装配bean。都可以写在字段上，或写在setter方法上。</p><p>2、@Autowired默认按类型装配（属于spring规范），默认情况下必须要求依赖对象必须存在，如果要允许null 值，可以设置它的required属性为false，如：@Autowired(required=false) ，如果我们想使用名称装配可以结合@Qualifier注解进行使用</p><p>3、@Resource（属于J2EE复返），默认按照名称进行装配，名称可以通过name属性进行指定。如果没有指定name属性，当注解写在字段上时，默认取字段名进行按照名称查找，如果注解写在setter方法上默认取属性名进行装配。当找不到与名称匹配的bean时才按照类型进行装配。但是需要注意的是，如果name属性一旦指定，就只会按照名称进行装配。</p><p>它们的作用相同都是用注解方式注入对象，但执行顺序不同。@Autowired先byType，@Resource先byName。</p><h2 id=8使用注解开发>8.使用注解开发</h2><blockquote><p>说明</p></blockquote><p>在spring4之后，想要使用注解形式，必须得要引入aop的包</p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613182026555.png alt=在这里插入图片描述></p><p>在配置文件当中，还得要引入一个context约束</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;?</span>xml version<span style=color:#666>=</span><span style=color:#b44>&#34;1.0&#34;</span> encoding<span style=color:#666>=</span><span style=color:#b44>&#34;UTF-8&#34;</span><span style=color:#666>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>beans xmlns<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>      xmlns<span style=color:#666>:</span>xsi<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>      xmlns<span style=color:#666>:</span>context<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/context&#34;</span>
</span></span><span style=display:flex><span>      xsi<span style=color:#666>:</span>schemaLocation<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#b44>       http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#b44>       http://www.springframework.org/schema/context
</span></span></span><span style=display:flex><span><span style=color:#b44>       http://www.springframework.org/schema/context/spring-context.xsd&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>beans<span style=color:#666>&gt;</span>
</span></span></code></pre></div><h3 id=81bean的实现>8.1.Bean的实现</h3><p>我们之前都是使用 bean 的标签进行bean注入，但是实际开发中，我们一般都会使用注解！</p><h4 id=1配置扫描哪些包下的注解>1、配置扫描哪些包下的注解</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span><span>指定注解扫描包</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>context<span style=color:#666>:</span>component<span style=color:#666>-</span>scan base<span style=color:#666>-</span>package<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo&#34;</span><span style=color:#666>/&gt;</span>
</span></span></code></pre></div><p>2、在指定包下编写类，增加注解</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Component</span><span style=color:#666>(</span><span style=color:#b44>&#34;user&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic>// 相当于配置文件中 &lt;bean id=&#34;user&#34; class=&#34;当前注解的类&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>User</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> String name <span style=color:#666>=</span> <span style=color:#b44>&#34;秦疆&#34;</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>3、测试</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>   ApplicationContext applicationContext <span style=color:#666>=</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>new</span> ClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;beans.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   User user <span style=color:#666>=</span> <span style=color:#666>(</span>User<span style=color:#666>)</span> applicationContext<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;user&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>user<span style=color:#666>.</span><span style=color:#b44>name</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><h3 id=82属性注入>8.2.属性注入</h3><p>使用注解注入属性</p><p>1、可以不用提供set方法，直接在直接名上添加@value(“值”)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Component</span><span style=color:#666>(</span><span style=color:#b44>&#34;user&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic>// 相当于配置文件中 &lt;bean id=&#34;user&#34; class=&#34;当前注解的类&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>User</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Value</span><span style=color:#666>(</span><span style=color:#b44>&#34;秦疆&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>// 相当于配置文件中 &lt;property name=&#34;name&#34; value=&#34;秦疆&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>public</span> String name<span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>2、如果提供了set方法，在set方法上添加@value(“值”);</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Component</span><span style=color:#666>(</span><span style=color:#b44>&#34;user&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>User</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> String name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Value</span><span style=color:#666>(</span><span style=color:#b44>&#34;秦疆&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setName</span><span style=color:#666>(</span>String name<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>name</span> <span style=color:#666>=</span> name<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><h3 id=83衍生注解>8.3.衍生注解</h3><p>我们这些注解，就是替代了在配置文件当中配置步骤而已！更加的方便快捷！</p><p><strong>@Component三个衍生注解</strong></p><p>为了更好的进行分层，Spring可以使用其它三个注解，功能一样，目前使用哪一个功能都一样。</p><ul><li>@Controller：controller层</li><li>@Service：service层</li><li>@Repository：dao层</li></ul><p>写上这些注解，就相当于将这个类交给Spring管理装配了！</p><h3 id=84自动装配注解>8.4.自动装配注解</h3><p>在Bean的自动装配已经讲过了，可以回顾！</p><h3 id=85作用域>8.5.作用域</h3><p>@scope</p><ul><li>singleton：默认的，Spring会采用单例模式创建这个对象。关闭工厂 ，所有的对象都会销毁。</li><li>prototype：多例模式。关闭工厂 ，所有的对象不会销毁。内部的垃圾回收机制会回收</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Controller</span><span style=color:#666>(</span><span style=color:#b44>&#34;user&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span><span style=color:#a2f>@Scope</span><span style=color:#666>(</span><span style=color:#b44>&#34;prototype&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>User</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Value</span><span style=color:#666>(</span><span style=color:#b44>&#34;秦疆&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> String name<span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><h3 id=86小结>8.6.小结</h3><p><strong>XML与注解比较</strong></p><ul><li>XML可以适用任何场景 ，结构清晰，维护方便</li><li>注解不是自己提供的类使用不了，开发简单方便</li></ul><p><strong>xml与注解整合开发</strong> ：推荐最佳实践</p><ul><li>xml管理Bean</li><li>注解完成属性注入</li><li>使用过程中， 可以不用扫描，扫描是为了类上的注解</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;</span>context<span style=color:#666>:</span>annotation<span style=color:#666>-</span>config<span style=color:#666>/&gt;</span>  
</span></span></code></pre></div><p>作用：</p><ul><li>进行注解驱动注册，从而使注解生效</li><li>用于激活那些已经在spring容器里注册过的bean上面的注解，也就是显示的向Spring注册</li><li>如果不扫描包，就需要手动配置bean</li><li>如果不加注解驱动，则注入的值为null！</li></ul><h2 id=9基于java类进行配置>9.基于Java类进行配置</h2><p>JavaConfig 原来是 Spring 的一个子项目，它通过 Java 类的方式提供 Bean 的定义信息，在 Spring4 的版本， JavaConfig 已正式成为 Spring4 的核心功能 。</p><p>测试：</p><p>1、编写一个实体类，Dog</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Component</span>  <span style=color:#080;font-style:italic>//将这个类标注为Spring的一个组件，放到容器中！
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Dog</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> String name <span style=color:#666>=</span> <span style=color:#b44>&#34;dog&#34;</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>2、新建一个config配置包，编写一个MyConfig配置类</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Configuration</span>  <span style=color:#080;font-style:italic>//代表这是一个配置类
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>MyConfig</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Bean</span> <span style=color:#080;font-style:italic>//通过方法注册一个bean，这里的返回值就Bean的类型，方法名就是bean的id！
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>public</span> Dog <span style=color:#00a000>dog</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> <span style=color:#a2f;font-weight:700>new</span> Dog<span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>3、测试</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test2</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>   ApplicationContext applicationContext <span style=color:#666>=</span>
</span></span><span style=display:flex><span>           <span style=color:#a2f;font-weight:700>new</span> AnnotationConfigApplicationContext<span style=color:#666>(</span>MyConfig<span style=color:#666>.</span><span style=color:#b44>class</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   Dog dog <span style=color:#666>=</span> <span style=color:#666>(</span>Dog<span style=color:#666>)</span> applicationContext<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;dog&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>dog<span style=color:#666>.</span><span style=color:#b44>name</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>4、成功输出结果！</p><p><strong>导入其他配置如何做呢？</strong></p><p>1、我们再编写一个配置类！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Configuration</span>  <span style=color:#080;font-style:italic>//代表这是一个配置类
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>MyConfig2</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>2、在之前的配置类中我们来选择导入这个配置类</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a2f>@Import</span><span style=color:#666>(</span>MyConfig2<span style=color:#666>.</span><span style=color:#b44>class</span><span style=color:#666>)</span>  <span style=color:#080;font-style:italic>//导入合并其他配置类，类似于配置文件中的 inculde 标签
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>MyConfig</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Bean</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> Dog <span style=color:#00a000>dog</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> <span style=color:#a2f;font-weight:700>new</span> Dog<span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>关于这种Java类的配置方式，我们在之后的SpringBoot 和 SpringCloud中还会大量看到，我们需要知道这些注解的作用即可！</p><h2 id=10代理模式>10.代理模式</h2><p>为什么要学习代理模式，因为AOP的底层机制就是动态代理！</p><p>代理模式：</p><ul><li>静态代理</li><li>动态代理</li></ul><p>学习aop之前 , 我们要先了解一下代理模式！</p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613182049247.png alt=在这里插入图片描述></p><h3 id=101静态代理>10.1静态代理</h3><p><strong>静态代理角色分析</strong></p><ul><li>抽象角色 : 一般使用接口或者抽象类来实现</li><li>真实角色 : 被代理的角色</li><li>代理角色 : 代理真实角色 ; 代理真实角色后 , 一般会做一些附属的操作 .</li><li>客户 : 使用代理角色来进行一些操作 .</li></ul><p><strong>代码实现</strong></p><p>Rent . java 即抽象角色</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#080;font-style:italic>//抽象角色：租房
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>interface</span> <span style=color:#00f>Rent</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>rent</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>Host . java 即真实角色</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#080;font-style:italic>//真实角色: 房东，房东要出租房子
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Host</span> <span style=color:#a2f;font-weight:700>implements</span> Rent<span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>rent</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;房屋出租&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>Proxy . java 即代理角色</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#080;font-style:italic>//代理角色：中介
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Proxy</span> <span style=color:#a2f;font-weight:700>implements</span> Rent <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> Host host<span style=color:#666>;</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#00a000>Proxy</span><span style=color:#666>()</span> <span style=color:#666>{</span> <span style=color:#666>}</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#00a000>Proxy</span><span style=color:#666>(</span>Host host<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>host</span> <span style=color:#666>=</span> host<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//租房
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>rent</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       seeHouse<span style=color:#666>();</span>
</span></span><span style=display:flex><span>       host<span style=color:#666>.</span><span style=color:#b44>rent</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>       fare<span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//看房
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>seeHouse</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;带房客看房&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//收中介费
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>fare</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;收中介费&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span></code></pre></div><p>Client . java 即客户</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#080;font-style:italic>//客户类，一般客户都会去找代理！
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Client</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>static</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>main</span><span style=color:#666>(</span>String<span style=color:#666>[]</span> args<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#080;font-style:italic>//房东要租房
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       Host host <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> Host<span style=color:#666>();</span>
</span></span><span style=display:flex><span>       <span style=color:#080;font-style:italic>//中介帮助房东
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       Proxy proxy <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> Proxy<span style=color:#666>(</span>host<span style=color:#666>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#080;font-style:italic>//你去找中介！
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       proxy<span style=color:#666>.</span><span style=color:#b44>rent</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>分析：在这个过程中，你直接接触的就是中介，就如同现实生活中的样子，你看不到房东，但是你依旧租到了房东的房子通过代理，这就是所谓的代理模式，程序源自于生活，所以学编程的人，一般能够更加抽象的看待生活中发生的事情。</p><p><strong>静态代理的好处:</strong></p><ul><li>可以使得我们的真实角色更加纯粹 . 不再去关注一些公共的事情 .</li><li>公共的业务由代理来完成 . 实现了业务的分工 ,</li><li>公共业务发生扩展时变得更加集中和方便 .</li></ul><p>缺点 :</p><ul><li>类多了 , 多了代理类 , 工作量变大了 . 开发效率降低 .</li></ul><p>我们想要静态代理的好处，又不想要静态代理的缺点，所以 , 就有了动态代理 !</p><h3 id=102静态代理再理解>10.2.静态代理再理解</h3><p>同学们练习完毕后，我们再来举一个例子，巩固大家的学习！</p><p>练习步骤：</p><p>1、创建一个抽象角色，比如咋们平时做的用户业务，抽象起来就是增删改查！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#080;font-style:italic>//抽象角色：增删改查业务
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>interface</span> <span style=color:#00f>UserService</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>add</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>   <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>delete</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>   <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>update</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>   <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>query</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>2、我们需要一个真实对象来完成这些增删改查操作</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#080;font-style:italic>//真实对象，完成增删改查操作的人
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserServiceImpl</span> <span style=color:#a2f;font-weight:700>implements</span> UserService <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>add</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;增加了一个用户&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>delete</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;删除了一个用户&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>update</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;更新了一个用户&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>query</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;查询了一个用户&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>3、需求来了，现在我们需要增加一个日志功能，怎么实现！</p><ul><li>思路1 ：在实现类上增加代码 【麻烦！】</li><li>思路2：使用代理来做，能够不改变原来的业务情况下，实现此功能就是最好的了！</li></ul><p>4、设置一个代理类来处理日志！代理角色</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#080;font-style:italic>//代理角色，在这里面增加日志的实现
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserServiceProxy</span> <span style=color:#a2f;font-weight:700>implements</span> UserService <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> UserServiceImpl userService<span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setUserService</span><span style=color:#666>(</span>UserServiceImpl userService<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>userService</span> <span style=color:#666>=</span> userService<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>add</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       log<span style=color:#666>(</span><span style=color:#b44>&#34;add&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       userService<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>delete</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       log<span style=color:#666>(</span><span style=color:#b44>&#34;delete&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       userService<span style=color:#666>.</span><span style=color:#b44>delete</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>update</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       log<span style=color:#666>(</span><span style=color:#b44>&#34;update&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       userService<span style=color:#666>.</span><span style=color:#b44>update</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>query</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       log<span style=color:#666>(</span><span style=color:#b44>&#34;query&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       userService<span style=color:#666>.</span><span style=color:#b44>query</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>log</span><span style=color:#666>(</span>String msg<span style=color:#666>){</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;执行了&#34;</span><span style=color:#666>+</span>msg<span style=color:#666>+</span><span style=color:#b44>&#34;方法&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>5、测试访问类：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Client</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>static</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>main</span><span style=color:#666>(</span>String<span style=color:#666>[]</span> args<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#080;font-style:italic>//真实业务
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       UserServiceImpl userService <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> UserServiceImpl<span style=color:#666>();</span>
</span></span><span style=display:flex><span>       <span style=color:#080;font-style:italic>//代理类
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       UserServiceProxy proxy <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> UserServiceProxy<span style=color:#666>();</span>
</span></span><span style=display:flex><span>       <span style=color:#080;font-style:italic>//使用代理类实现日志功能！
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       proxy<span style=color:#666>.</span><span style=color:#b44>setUserService</span><span style=color:#666>(</span>userService<span style=color:#666>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       proxy<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>OK，到了现在代理模式大家应该都没有什么问题了，重点大家需要理解其中的思想；</p><p>我们在不改变原来的代码的情况下，实现了对原有功能的增强，这是AOP中最核心的思想</p><p>聊聊AOP：纵向开发，横向开发</p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613182103390.png alt=在这里插入图片描述></p><h3 id=103动态代理>10.3动态代理</h3><ul><li>动态代理的角色和静态代理的一样 .</li><li>动态代理的代理类是动态生成的 . 静态代理的代理类是我们提前写好的</li><li>动态代理分为两类 : 一类是基于接口动态代理 , 一类是基于类的动态代理</li><li><ul><li>基于接口的动态代理&mdash;-JDK动态代理</li><li>基于类的动态代理–cglib</li><li>现在用的比较多的是 javasist 来生成动态代理 . 百度一下javasist</li><li>我们这里使用JDK的原生代码来实现，其余的道理都是一样的！、</li></ul></li></ul><p><strong>JDK的动态代理需要了解两个类</strong></p><p>核心 : InvocationHandler 和 Proxy ， 打开JDK帮助文档看看</p><p>【InvocationHandler：调用处理程序】</p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613182109423.png alt=在这里插入图片描述></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Object <span style=color:#00a000>invoke</span><span style=color:#666>(</span>Object proxy<span style=color:#666>,</span> <span>方法</span> method<span style=color:#666>,</span> Object<span style=color:#666>[]</span> args<span style=color:#666>)</span><span>；</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic>//参数
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic>//proxy - 调用该方法的代理实例
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic>//method -所述方法对应于调用代理实例上的接口方法的实例。方法对象的声明类将是该方法声明的接口，它可以是代理类继承该方法的代理接口的超级接口。
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic>//args -包含的方法调用传递代理实例的参数值的对象的阵列，或null如果接口方法没有参数。原始类型的参数包含在适当的原始包装器类的实例中，例如java.lang.Integer或java.lang.Boolean 。
</span></span></span></code></pre></div><p>【Proxy : 代理】</p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613182114160.png alt=在这里插入图片描述></p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/2020061318211829.png alt=在这里插入图片描述></p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613182123606.png alt=在这里插入图片描述></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#080;font-style:italic>//生成代理类
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> Object <span style=color:#00a000>getProxy</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>return</span> Proxy<span style=color:#666>.</span><span style=color:#b44>newProxyInstance</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>getClass</span><span style=color:#666>().</span><span style=color:#b44>getClassLoader</span><span style=color:#666>(),</span>
</span></span><span style=display:flex><span>                                 rent<span style=color:#666>.</span><span style=color:#b44>getClass</span><span style=color:#666>().</span><span style=color:#b44>getInterfaces</span><span style=color:#666>(),</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p><strong>代码实现</strong></p><p>抽象角色和真实角色和之前的一样！</p><p>Rent . java 即抽象角色</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>//抽象角色：租房
</span></span><span style=display:flex><span>public interface Rent {
</span></span><span style=display:flex><span>   public void rent();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>1234
</span></span></code></pre></div><p>Host . java 即真实角色</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>//真实角色: 房东，房东要出租房子
</span></span><span style=display:flex><span>public class Host implements Rent{
</span></span><span style=display:flex><span>   public void rent() {
</span></span><span style=display:flex><span>       System.out.println(&#34;房屋出租&#34;);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>123456
</span></span></code></pre></div><p>ProxyInvocationHandler. java 即代理角色</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>public class ProxyInvocationHandler implements InvocationHandler {
</span></span><span style=display:flex><span>   private Rent rent;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   public void setRent(Rent rent) {
</span></span><span style=display:flex><span>       this.rent = rent;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   //生成代理类，重点是第二个参数，获取要代理的抽象角色！之前都是一个角色，现在可以代理一类角色
</span></span><span style=display:flex><span>   public Object getProxy(){
</span></span><span style=display:flex><span>       return Proxy.newProxyInstance(this.getClass().getClassLoader(),
</span></span><span style=display:flex><span>               rent.getClass().getInterfaces(),this);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   // proxy : 代理类 method : 代理类的调用处理程序的方法对象.
</span></span><span style=display:flex><span>   // 处理代理实例上的方法调用并返回结果
</span></span><span style=display:flex><span>   @Override
</span></span><span style=display:flex><span>   public Object invoke(Object proxy, Method method, Object[] args) throwsThrowable {
</span></span><span style=display:flex><span>       seeHouse();
</span></span><span style=display:flex><span>       //核心：本质利用反射实现！
</span></span><span style=display:flex><span>       Object result = method.invoke(rent, args);
</span></span><span style=display:flex><span>       fare();
</span></span><span style=display:flex><span>       return result;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   //看房
</span></span><span style=display:flex><span>   public void seeHouse(){
</span></span><span style=display:flex><span>       System.out.println(&#34;带房客看房&#34;);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>   //收中介费
</span></span><span style=display:flex><span>   public void fare(){
</span></span><span style=display:flex><span>       System.out.println(&#34;收中介费&#34;);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>12345678910111213141516171819202122232425262728293031323334
</span></span></code></pre></div><p>Client . java</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#080;font-style:italic>//租客
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Client</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>static</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>main</span><span style=color:#666>(</span>String<span style=color:#666>[]</span> args<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#080;font-style:italic>//真实角色
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       Host host <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> Host<span style=color:#666>();</span>
</span></span><span style=display:flex><span>       <span style=color:#080;font-style:italic>//代理实例的调用处理程序
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       ProxyInvocationHandler pih <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ProxyInvocationHandler<span style=color:#666>();</span>
</span></span><span style=display:flex><span>       pih<span style=color:#666>.</span><span style=color:#b44>setRent</span><span style=color:#666>(</span>host<span style=color:#666>);</span> <span style=color:#080;font-style:italic>//将真实角色放置进去！
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       Rent proxy <span style=color:#666>=</span> <span style=color:#666>(</span>Rent<span style=color:#666>)</span>pih<span style=color:#666>.</span><span style=color:#b44>getProxy</span><span style=color:#666>();</span> <span style=color:#080;font-style:italic>//动态生成对应的代理类！
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       proxy<span style=color:#666>.</span><span style=color:#b44>rent</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>核心：<strong>一个动态代理 , 一般代理某一类业务 , 一个动态代理可以代理多个类，代理的是接口！、</strong></p><h3 id=104深化理解>10.4深化理解</h3><p>我们来使用动态代理实现代理我们后面写的UserService！</p><p>我们也可以编写一个通用的动态代理实现的类！所有的代理对象设置为Object即可！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>ProxyInvocationHandler</span> <span style=color:#a2f;font-weight:700>implements</span> InvocationHandler <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> Object target<span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setTarget</span><span style=color:#666>(</span>Object target<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>target</span> <span style=color:#666>=</span> target<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//生成代理类
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>public</span> Object <span style=color:#00a000>getProxy</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> Proxy<span style=color:#666>.</span><span style=color:#b44>newProxyInstance</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>getClass</span><span style=color:#666>().</span><span style=color:#b44>getClassLoader</span><span style=color:#666>(),</span>
</span></span><span style=display:flex><span>               target<span style=color:#666>.</span><span style=color:#b44>getClass</span><span style=color:#666>().</span><span style=color:#b44>getInterfaces</span><span style=color:#666>(),</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>// proxy : 代理类
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#080;font-style:italic>// method : 代理类的调用处理程序的方法对象.
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>public</span> Object <span style=color:#00a000>invoke</span><span style=color:#666>(</span>Object proxy<span style=color:#666>,</span> Method method<span style=color:#666>,</span> Object<span style=color:#666>[]</span> args<span style=color:#666>)</span> throwsThrowable <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       log<span style=color:#666>(</span>method<span style=color:#666>.</span><span style=color:#b44>getName</span><span style=color:#666>());</span>
</span></span><span style=display:flex><span>       Object result <span style=color:#666>=</span> method<span style=color:#666>.</span><span style=color:#b44>invoke</span><span style=color:#666>(</span>target<span style=color:#666>,</span> args<span style=color:#666>);</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> result<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>log</span><span style=color:#666>(</span>String methodName<span style=color:#666>){</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;执行了&#34;</span><span style=color:#666>+</span>methodName<span style=color:#666>+</span><span style=color:#b44>&#34;方法&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>测试！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Test</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>static</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>main</span><span style=color:#666>(</span>String<span style=color:#666>[]</span> args<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#080;font-style:italic>//真实对象
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       UserServiceImpl userService <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> UserServiceImpl<span style=color:#666>();</span>
</span></span><span style=display:flex><span>       <span style=color:#080;font-style:italic>//代理对象的调用处理程序
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       ProxyInvocationHandler pih <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ProxyInvocationHandler<span style=color:#666>();</span>
</span></span><span style=display:flex><span>       pih<span style=color:#666>.</span><span style=color:#b44>setTarget</span><span style=color:#666>(</span>userService<span style=color:#666>);</span> <span style=color:#080;font-style:italic>//设置要代理的对象
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       UserService proxy <span style=color:#666>=</span> <span style=color:#666>(</span>UserService<span style=color:#666>)</span>pih<span style=color:#666>.</span><span style=color:#b44>getProxy</span><span style=color:#666>();</span> <span style=color:#080;font-style:italic>//动态生成代理类！
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       proxy<span style=color:#666>.</span><span style=color:#b44>delete</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>测试，增删改查，查看结果！</p><h3 id=105动态代理的好处>10.5动态代理的好处</h3><p>静态代理有的它都有，静态代理没有的，它也有！</p><ul><li>可以使得我们的真实角色更加纯粹 . 不再去关注一些公共的事情 .</li><li>公共的业务由代理来完成 . 实现了业务的分工 ,</li><li>公共业务发生扩展时变得更加集中和方便 .</li><li>一个动态代理 , 一般代理某一类业务</li><li>一个动态代理可以代理多个类，代理的是接口！</li></ul><h2 id=11aop>11.AOP</h2><h3 id=111什么是aop>11.1.什么是AOP</h3><p>AOP（Aspect Oriented Programming）意为：面向切面编程，通过预编译方式和运行期动态代理实现程序功能的统一维护的一种技术。AOP是OOP的延续，是软件开发中的一个热点，也是Spring框架中的一个重要内容，是函数式编程的一种衍生范型。利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。</p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613182135382.png alt=在这里插入图片描述></p><h3 id=112aop在spring中的作用>11.2.Aop在Spring中的作用</h3><p>提供声明式事务；允许用户自定义切面</p><p>以下名词需要了解下：</p><ul><li>横切关注点：跨越应用程序多个模块的方法或功能。即是，与我们业务逻辑无关的，但是我们需要关注的部分，就是横切关注点。如日志 , 安全 , 缓存 , 事务等等 …</li><li>切面（ASPECT）：横切关注点 被模块化 的特殊对象。即，它是一个类。</li><li>通知（Advice）：切面必须要完成的工作。即，它是类中的一个方法。</li><li>目标（Target）：被通知对象。</li><li>代理（Proxy）：向目标对象应用通知之后创建的对象。</li><li>切入点（PointCut）：切面通知 执行的 “地点”的定义。</li><li>连接点（JointPoint）：与切入点匹配的执行点。</li></ul><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613182141599.png alt=在这里插入图片描述></p><p>SpringAOP中，通过Advice定义横切逻辑，Spring中支持5种类型的Advice:</p><p><img src="https://img-blog.csdnimg.cn/20200613182147344.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDIwNzQwMw==,size_16,color_FFFFFF,t_70" alt=在这里插入图片描述></p><p>即 Aop 在 不改变原有代码的情况下 , 去增加新的功能 .</p><h3 id=113使用spring实现aop>11.3.使用Spring实现Aop</h3><p>【重点】使用AOP织入，需要导入一个依赖包！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span> https<span style=color:#666>:</span><span style=color:#080;font-style:italic>//mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#666>&lt;</span>dependency<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>groupId<span style=color:#666>&gt;</span>org<span style=color:#666>.</span><span style=color:#b44>aspectj</span><span style=color:#666>&lt;/</span>groupId<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>artifactId<span style=color:#666>&gt;</span>aspectjweaver<span style=color:#666>&lt;/</span>artifactId<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>version<span style=color:#666>&gt;</span><span style=color:#666>1.9.4</span><span style=color:#666>&lt;/</span>version<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>dependency<span style=color:#666>&gt;</span>
</span></span></code></pre></div><h4 id=1131通过-spring-api-实现>11.3.1.通过 Spring API 实现</h4><p><strong>第一种方式</strong></p><p>首先编写我们的业务接口和实现类</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>interface</span> <span style=color:#00f>UserService</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>add</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>delete</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>update</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>search</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserServiceImpl</span> <span style=color:#a2f;font-weight:700>implements</span> UserService<span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>add</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;增加用户&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>delete</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;删除用户&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>update</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;更新用户&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>search</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;查询用户&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>然后去写我们的增强类 , 我们编写两个 , 一个前置增强 一个后置增强</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>Log</span> <span style=color:#a2f;font-weight:700>implements</span> MethodBeforeAdvice <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//method : 要执行的目标对象的方法
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#080;font-style:italic>//objects : 被调用的方法的参数
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#080;font-style:italic>//Object : 目标对象
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>before</span><span style=color:#666>(</span>Method method<span style=color:#666>,</span> Object<span style=color:#666>[]</span> objects<span style=color:#666>,</span> Object o<span style=color:#666>)</span> <span style=color:#a2f;font-weight:700>throws</span> Throwable <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span> o<span style=color:#666>.</span><span style=color:#b44>getClass</span><span style=color:#666>().</span><span style=color:#b44>getName</span><span style=color:#666>()</span> <span style=color:#666>+</span> <span style=color:#b44>&#34;的&#34;</span> <span style=color:#666>+</span> method<span style=color:#666>.</span><span style=color:#b44>getName</span><span style=color:#666>()</span> <span style=color:#666>+</span> <span style=color:#b44>&#34;方法被执行了&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>AfterLog</span> <span style=color:#a2f;font-weight:700>implements</span> AfterReturningAdvice <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//returnValue 返回值
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#080;font-style:italic>//method被调用的方法
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#080;font-style:italic>//args 被调用的方法的对象的参数
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#080;font-style:italic>//target 被调用的目标对象
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>afterReturning</span><span style=color:#666>(</span>Object returnValue<span style=color:#666>,</span> Method method<span style=color:#666>,</span> Object<span style=color:#666>[]</span> args<span style=color:#666>,</span>Object target<span style=color:#666>)</span> <span style=color:#a2f;font-weight:700>throws</span> Throwable <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;执行了&#34;</span> <span style=color:#666>+</span> target<span style=color:#666>.</span><span style=color:#b44>getClass</span><span style=color:#666>().</span><span style=color:#b44>getName</span><span style=color:#666>()</span>
</span></span><span style=display:flex><span>       <span style=color:#666>+</span><span style=color:#b44>&#34;的&#34;</span><span style=color:#666>+</span>method<span style=color:#666>.</span><span style=color:#b44>getName</span><span style=color:#666>()+</span><span style=color:#b44>&#34;方法,&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>+</span><span style=color:#b44>&#34;返回值：&#34;</span><span style=color:#666>+</span>returnValue<span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>最后去spring的文件中注册 , 并实现aop切入实现 , 注意导入约束 .</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;?</span>xml version<span style=color:#666>=</span><span style=color:#b44>&#34;1.0&#34;</span> encoding<span style=color:#666>=</span><span style=color:#b44>&#34;UTF-8&#34;</span><span style=color:#666>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>beans xmlns<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>      xmlns<span style=color:#666>:</span>xsi<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>      xmlns<span style=color:#666>:</span>aop<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/aop&#34;</span>
</span></span><span style=display:flex><span>      xsi<span style=color:#666>:</span>schemaLocation<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#b44>       http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span style=display:flex><span><span style=color:#b44>       http://www.springframework.org/schema/aop
</span></span></span><span style=display:flex><span><span style=color:#b44>       http://www.springframework.org/schema/aop/spring-aop.xsd&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;!--</span><span>注册</span>bean<span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;userService&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.service.UserServiceImpl&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;log&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.log.Log&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;afterLog&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.log.AfterLog&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;!--</span>aop<span>的配置</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>config<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;!--</span><span>切入点</span> expression<span style=color:#666>:</span><span>表达式匹配要执行的方法</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>pointcut id<span style=color:#666>=</span><span style=color:#b44>&#34;pointcut&#34;</span> expression<span style=color:#666>=</span><span style=color:#b44>&#34;execution(* com.kuang.service.UserServiceImpl.*(..))&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;!--</span><span>执行环绕</span><span style=color:#666>;</span> advice<span style=color:#666>-</span>ref<span>执行方法</span> <span style=color:#666>.</span> pointcut<span style=color:#666>-</span>ref<span>切入点</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>advisor advice<span style=color:#666>-</span>ref<span style=color:#666>=</span><span style=color:#b44>&#34;log&#34;</span> pointcut<span style=color:#666>-</span>ref<span style=color:#666>=</span><span style=color:#b44>&#34;pointcut&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>advisor advice<span style=color:#666>-</span>ref<span style=color:#666>=</span><span style=color:#b44>&#34;afterLog&#34;</span> pointcut<span style=color:#666>-</span>ref<span style=color:#666>=</span><span style=color:#b44>&#34;pointcut&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>aop<span style=color:#666>:</span>config<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>beans<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>测试</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>MyTest</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       ApplicationContext context <span style=color:#666>=</span> newClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;beans.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       UserService userService <span style=color:#666>=</span> <span style=color:#666>(</span>UserService<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;userService&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       userService<span style=color:#666>.</span><span style=color:#b44>search</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>Aop的重要性 : 很重要 . 一定要理解其中的思路 , 主要是思想的理解这一块 .</p><p>Spring的Aop就是将公共的业务 (日志 , 安全等) 和领域业务结合起来 , 当执行领域业务时 , 将会把公共业务加进来 . 实现公共业务的重复利用 . 领域业务更纯粹 , 程序猿专注领域业务 , 其本质还是动态代理 .</p><h4 id=1132自定义类来实现aop>11.3.2.自定义类来实现Aop</h4><p><strong>第二种方式</strong></p><p>目标业务类不变依旧是userServiceImpl</p><p>第一步 : 写我们自己的一个切入类</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>DiyPointcut</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>before</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;---------方法执行前---------&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>after</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;---------方法执行后---------&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>   
</span></span></code></pre></div><p>去spring中配置</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span><span>第二种方式自定义实现</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;!--</span><span>注册</span>bean<span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;diy&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.config.DiyPointcut&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;!--</span>aop<span>的配置</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>config<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;!--</span><span>第二种方式：使用</span>AOP<span>的标签实现</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>aspect ref<span style=color:#666>=</span><span style=color:#b44>&#34;diy&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>pointcut id<span style=color:#666>=</span><span style=color:#b44>&#34;diyPonitcut&#34;</span> expression<span style=color:#666>=</span><span style=color:#b44>&#34;execution(* com.kuang.service.UserServiceImpl.*(..))&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>before pointcut<span style=color:#666>-</span>ref<span style=color:#666>=</span><span style=color:#b44>&#34;diyPonitcut&#34;</span> method<span style=color:#666>=</span><span style=color:#b44>&#34;before&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>after pointcut<span style=color:#666>-</span>ref<span style=color:#666>=</span><span style=color:#b44>&#34;diyPonitcut&#34;</span> method<span style=color:#666>=</span><span style=color:#b44>&#34;after&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>aop<span style=color:#666>:</span>aspect<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>aop<span style=color:#666>:</span>config<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>测试：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>MyTest</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       ApplicationContext context <span style=color:#666>=</span> newClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;beans.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       UserService userService <span style=color:#666>=</span> <span style=color:#666>(</span>UserService<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;userService&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       userService<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><h4 id=1134使用注解实现>11.3.4.使用注解实现</h4><p><strong>第三种方式</strong></p><p>第一步：编写一个注解实现的增强类</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>package</span> <span style=color:#00f;font-weight:700>com.kuang.config</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>org.aspectj.lang.ProceedingJoinPoint</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>org.aspectj.lang.annotation.After</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>org.aspectj.lang.annotation.Around</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>org.aspectj.lang.annotation.Aspect</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>org.aspectj.lang.annotation.Before</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f>@Aspect</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>AnnotationPointcut</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Before</span><span style=color:#666>(</span><span style=color:#b44>&#34;execution(* com.kuang.service.UserServiceImpl.*(..))&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>before</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;---------方法执行前---------&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@After</span><span style=color:#666>(</span><span style=color:#b44>&#34;execution(* com.kuang.service.UserServiceImpl.*(..))&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>after</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;---------方法执行后---------&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f>@Around</span><span style=color:#666>(</span><span style=color:#b44>&#34;execution(* com.kuang.service.UserServiceImpl.*(..))&#34;</span><span style=color:#666>)</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>around</span><span style=color:#666>(</span>ProceedingJoinPoint jp<span style=color:#666>)</span> <span style=color:#a2f;font-weight:700>throws</span> Throwable <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;环绕前&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;签名:&#34;</span><span style=color:#666>+</span>jp<span style=color:#666>.</span><span style=color:#b44>getSignature</span><span style=color:#666>());</span>
</span></span><span style=display:flex><span>       <span style=color:#080;font-style:italic>//执行目标方法proceed
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>       Object proceed <span style=color:#666>=</span> jp<span style=color:#666>.</span><span style=color:#b44>proceed</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span><span style=color:#b44>&#34;环绕后&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>proceed<span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>第二步：在Spring配置文件中，注册bean，并增加支持注解的配置</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;!--第三种方式:注解实现--&gt;
</span></span><span style=display:flex><span>&lt;bean id=&#34;annotationPointcut&#34; class=&#34;com.kuang.config.AnnotationPointcut&#34;/&gt;
</span></span><span style=display:flex><span>&lt;aop:aspectj-autoproxy/&gt;
</span></span></code></pre></div><p>aop:aspectj-autoproxy：说明</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span>通过</span>aop<span>命名空间的</span><span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>aspectj<span style=color:#666>-</span>autoproxy <span style=color:#666>/&gt;</span><span>声明自动为</span>spring<span>容器中那些配置</span><span style=color:#a2f>@aspectJ</span><span>切面的</span>bean<span>创建代理，织入切面。当然，</span>spring <span>在内部依旧采用</span>AnnotationAwareAspectJAutoProxyCreator<span>进行自动代理的创建工作，但具体实现的细节已经被</span><span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>aspectj<span style=color:#666>-</span>autoproxy <span style=color:#666>/&gt;</span><span>隐藏起来了</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>aspectj<span style=color:#666>-</span>autoproxy <span style=color:#666>/&gt;</span><span>有一个</span>proxy<span style=color:#666>-</span>target<span style=color:#666>-</span>class<span>属性，默认为</span><span style=color:#a2f;font-weight:700>false</span><span>，表示使用</span>jdk<span>动态代理织入增强，当配为</span><span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>aspectj<span style=color:#666>-</span>autoproxy  poxy<span style=color:#666>-</span>target<span style=color:#666>-</span>class<span style=color:#666>=</span><span style=color:#b44>&#34;true&#34;</span><span style=color:#666>/&gt;</span><span>时，表示使用</span>CGLib<span>动态代理技术织入增强。不过即使</span>proxy<span style=color:#666>-</span>target<span style=color:#666>-</span>class<span>设置为</span><span style=color:#a2f;font-weight:700>false</span><span>，如果目标类没有声明接口，则</span>spring<span>将自动使用</span>CGLib<span>动态代理。</span>
</span></span></code></pre></div><h2 id=12整合mybatis>12.整合MyBatis</h2><blockquote><h4 id=步骤>步骤</h4></blockquote><p>1、导入相关jar包</p><p>junit</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;dependency&gt;
</span></span><span style=display:flex><span>   &lt;groupId&gt;junit&lt;/groupId&gt;
</span></span><span style=display:flex><span>   &lt;artifactId&gt;junit&lt;/artifactId&gt;
</span></span><span style=display:flex><span>   &lt;version&gt;4.12&lt;/version&gt;
</span></span><span style=display:flex><span>&lt;/dependency&gt;
</span></span></code></pre></div><p>mybatis</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;dependency&gt;
</span></span><span style=display:flex><span>   &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
</span></span><span style=display:flex><span>   &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
</span></span><span style=display:flex><span>   &lt;version&gt;3.5.2&lt;/version&gt;
</span></span><span style=display:flex><span>&lt;/dependency&gt;
</span></span></code></pre></div><p>mysql-connector-java</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;dependency&gt;
</span></span><span style=display:flex><span>   &lt;groupId&gt;mysql&lt;/groupId&gt;
</span></span><span style=display:flex><span>   &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
</span></span><span style=display:flex><span>   &lt;version&gt;5.1.47&lt;/version&gt;
</span></span><span style=display:flex><span>&lt;/dependency&gt;
</span></span></code></pre></div><p>spring相关</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;dependency&gt;
</span></span><span style=display:flex><span>   &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span></span><span style=display:flex><span>   &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
</span></span><span style=display:flex><span>   &lt;version&gt;5.1.10.RELEASE&lt;/version&gt;
</span></span><span style=display:flex><span>&lt;/dependency&gt;
</span></span><span style=display:flex><span>&lt;dependency&gt;
</span></span><span style=display:flex><span>   &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span></span><span style=display:flex><span>   &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
</span></span><span style=display:flex><span>   &lt;version&gt;5.1.10.RELEASE&lt;/version&gt;
</span></span><span style=display:flex><span>&lt;/dependency&gt;
</span></span></code></pre></div><p>aspectJ AOP 织入器</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;
</span></span><span style=display:flex><span>&lt;dependency&gt;
</span></span><span style=display:flex><span>   &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
</span></span><span style=display:flex><span>   &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;
</span></span><span style=display:flex><span>   &lt;version&gt;1.9.4&lt;/version&gt;
</span></span><span style=display:flex><span>&lt;/dependency&gt;
</span></span></code></pre></div><p>mybatis-spring整合包 【重点】</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;dependency&gt;
</span></span><span style=display:flex><span>   &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
</span></span><span style=display:flex><span>   &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
</span></span><span style=display:flex><span>   &lt;version&gt;2.0.2&lt;/version&gt;
</span></span><span style=display:flex><span>&lt;/dependency&gt;
</span></span></code></pre></div><p>配置Maven静态资源过滤问题！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>&lt;build&gt;
</span></span><span style=display:flex><span>   &lt;resources&gt;
</span></span><span style=display:flex><span>       &lt;resource&gt;
</span></span><span style=display:flex><span>           &lt;directory&gt;src/main/java&lt;/directory&gt;
</span></span><span style=display:flex><span>           &lt;includes&gt;
</span></span><span style=display:flex><span>               &lt;include&gt;**/*.properties&lt;/include&gt;
</span></span><span style=display:flex><span>               &lt;include&gt;**/*.xml&lt;/include&gt;
</span></span><span style=display:flex><span>           &lt;/includes&gt;
</span></span><span style=display:flex><span>           &lt;filtering&gt;true&lt;/filtering&gt;
</span></span><span style=display:flex><span>       &lt;/resource&gt;
</span></span><span style=display:flex><span>   &lt;/resources&gt;
</span></span><span style=display:flex><span>&lt;/build&gt;
</span></span></code></pre></div><p>2、编写配置文件</p><p>3、代码实现</p><h3 id=121回忆mybatis>12.1回忆MyBatis</h3><p><strong>编写pojo实体类</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>package</span> <span style=color:#00f;font-weight:700>com.kuang.pojo</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>User</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>private</span> <span style=color:#0b0;font-weight:700>int</span> id<span style=color:#666>;</span>  <span style=color:#080;font-style:italic>//id
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>private</span> String name<span style=color:#666>;</span>   <span style=color:#080;font-style:italic>//姓名
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>private</span> String pwd<span style=color:#666>;</span>   <span style=color:#080;font-style:italic>//密码
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#666>}</span>
</span></span></code></pre></div><p><strong>实现mybatis的配置文件</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;?</span>xml version<span style=color:#666>=</span><span style=color:#b44>&#34;1.0&#34;</span> encoding<span style=color:#666>=</span><span style=color:#b44>&#34;UTF-8&#34;</span> <span style=color:#666>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;!</span>DOCTYPE configuration
</span></span><span style=display:flex><span>       PUBLIC <span style=color:#b44>&#34;-//mybatis.org//DTD Config 3.0//EN&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#b44>&#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>configuration<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>typeAliases<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span><span style=color:#a2f;font-weight:700>package</span> <span style=color:#00f;font-weight:700>name</span><span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>typeAliases<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>environments <span style=color:#a2f;font-weight:700>default</span><span style=color:#666>=</span><span style=color:#b44>&#34;development&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>environment id<span style=color:#666>=</span><span style=color:#b44>&#34;development&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>           <span style=color:#666>&lt;</span>transactionManager type<span style=color:#666>=</span><span style=color:#b44>&#34;JDBC&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>           <span style=color:#666>&lt;</span>dataSource type<span style=color:#666>=</span><span style=color:#b44>&#34;POOLED&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;driver&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;com.mysql.jdbc.Driver&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;url&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;jdbc:mysql://localhost:3306/mybatis?useSSL=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=utf8&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;username&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;root&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>               <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;password&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;123456&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>           <span style=color:#666>&lt;/</span>dataSource<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;/</span>environment<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>environments<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>mappers<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span><span style=color:#a2f;font-weight:700>package</span> <span style=color:#00f;font-weight:700>name</span><span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.dao&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>mappers<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>configuration<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p><strong>UserDao接口编写</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>interface</span> <span style=color:#00f>UserMapper</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> List<span style=color:#666>&lt;</span>User<span style=color:#666>&gt;</span> <span style=color:#00a000>selectUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p><strong>接口对应的Mapper映射文件</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;?</span>xml version<span style=color:#666>=</span><span style=color:#b44>&#34;1.0&#34;</span> encoding<span style=color:#666>=</span><span style=color:#b44>&#34;UTF-8&#34;</span> <span style=color:#666>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;!</span>DOCTYPE mapper
</span></span><span style=display:flex><span>       PUBLIC <span style=color:#b44>&#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#b44>&#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>mapper namespace<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.dao.UserMapper&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>select id<span style=color:#666>=</span><span style=color:#b44>&#34;selectUser&#34;</span> resultType<span style=color:#666>=</span><span style=color:#b44>&#34;User&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>    select <span style=color:#666>*</span> from user
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>select<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>mapper<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p><strong>测试类</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>selectUser</span><span style=color:#666>()</span> <span style=color:#a2f;font-weight:700>throws</span> IOException <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   String resource <span style=color:#666>=</span> <span style=color:#b44>&#34;mybatis-config.xml&#34;</span><span style=color:#666>;</span>
</span></span><span style=display:flex><span>   InputStream inputStream <span style=color:#666>=</span> Resources<span style=color:#666>.</span><span style=color:#b44>getResourceAsStream</span><span style=color:#666>(</span>resource<span style=color:#666>);</span>
</span></span><span style=display:flex><span>   SqlSessionFactory sqlSessionFactory <span style=color:#666>=</span> newSqlSessionFactoryBuilder<span style=color:#666>().</span><span style=color:#b44>build</span><span style=color:#666>(</span>inputStream<span style=color:#666>);</span>
</span></span><span style=display:flex><span>   SqlSession sqlSession <span style=color:#666>=</span> sqlSessionFactory<span style=color:#666>.</span><span style=color:#b44>openSession</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   UserMapper mapper <span style=color:#666>=</span> sqlSession<span style=color:#666>.</span><span style=color:#b44>getMapper</span><span style=color:#666>(</span>UserMapper<span style=color:#666>.</span><span style=color:#b44>class</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   List<span style=color:#666>&lt;</span>User<span style=color:#666>&gt;</span> userList <span style=color:#666>=</span> mapper<span style=color:#666>.</span><span style=color:#b44>selectUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>for</span> <span style=color:#666>(</span>User user<span style=color:#666>:</span> userList<span style=color:#666>){</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>user<span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   sqlSession<span style=color:#666>.</span><span style=color:#b44>close</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><h3 id=122mybatis-spring学习>12.2.MyBatis-Spring学习</h3><p>引入Spring之前需要了解mybatis-spring包中的一些重要类；</p><p><a href=http://www.mybatis.org/spring/zh/index.html target=_blank rel=noopener>http://www.mybatis.org/spring/zh/index.html</a></p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/20200613182215232.png alt=在这里插入图片描述></p><p><strong>什么是 MyBatis-Spring？</strong></p><p>MyBatis-Spring 会帮助你将 MyBatis 代码无缝地整合到 Spring 中。</p><p><strong>知识基础</strong></p><p>在开始使用 MyBatis-Spring 之前，你需要先熟悉 Spring 和 MyBatis 这两个框架和有关它们的术语。这很重要</p><p>MyBatis-Spring 需要以下版本：</p><table><thead><tr><th>MyBatis-Spring</th><th>MyBatis</th><th>Spring 框架</th><th>Spring Batch</th><th>Java</th></tr></thead><tbody><tr><td>2.0</td><td>3.5+</td><td>5.0+</td><td>4.0+</td><td>Java 8+</td></tr><tr><td>1.3</td><td>3.4+</td><td>3.2.2+</td><td>2.1+</td><td>Java 6+</td></tr></tbody></table><p>如果使用 Maven 作为构建工具，仅需要在 pom.xml 中加入以下代码即可：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;</span>dependency<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>groupId<span style=color:#666>&gt;</span>org<span style=color:#666>.</span><span style=color:#b44>mybatis</span><span style=color:#666>&lt;/</span>groupId<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>artifactId<span style=color:#666>&gt;</span>mybatis<span style=color:#666>-</span>spring<span style=color:#666>&lt;/</span>artifactId<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>version<span style=color:#666>&gt;</span><span style=color:#666>2.0.2</span><span style=color:#666>&lt;/</span>version<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>dependency<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>要和 Spring 一起使用 MyBatis，需要在 Spring 应用上下文中定义至少两样东西：一个 SqlSessionFactory 和至少一个数据映射器类。</p><p>在 MyBatis-Spring 中，可使用SqlSessionFactoryBean来创建 SqlSessionFactory。要配置这个工厂 bean，只需要把下面代码放在 Spring 的 XML 配置文件中：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSessionFactory&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;org.mybatis.spring.SqlSessionFactoryBean&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;dataSource&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;dataSource&#34;</span> <span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>注意：SqlSessionFactory需要一个 DataSource（数据源）。这可以是任意的 DataSource，只需要和配置其它 Spring 数据库连接一样配置它就可以了。</p><p>在基础的 MyBatis 用法中，是通过 SqlSessionFactoryBuilder 来创建 SqlSessionFactory 的。而在 MyBatis-Spring 中，则使用 SqlSessionFactoryBean 来创建。</p><p>在 MyBatis 中，你可以使用 SqlSessionFactory 来创建 SqlSession。一旦你获得一个 session 之后，你可以使用它来执行映射了的语句，提交或回滚连接，最后，当不再需要它的时候，你可以关闭 session。</p><p>SqlSessionFactory有一个唯一的必要属性：用于 JDBC 的 DataSource。这可以是任意的 DataSource 对象，它的配置方法和其它 Spring 数据库连接是一样的。</p><p>一个常用的属性是 configLocation，它用来指定 MyBatis 的 XML 配置文件路径。它在需要修改 MyBatis 的基础配置非常有用。通常，基础配置指的是 &lt; settings> 或 &lt; typeAliases>元素。</p><p>需要注意的是，这个配置文件并不需要是一个完整的 MyBatis 配置。确切地说，任何环境配置（），数据源（）和 MyBatis 的事务管理器（）都会被忽略。SqlSessionFactoryBean 会创建它自有的 MyBatis 环境配置（Environment），并按要求设置自定义环境的值。</p><p>SqlSessionTemplate 是 MyBatis-Spring 的核心。作为 SqlSession 的一个实现，这意味着可以使用它无缝代替你代码中已经在使用的 SqlSession。</p><p>模板可以参与到 Spring 的事务管理中，并且由于其是线程安全的，可以供多个映射器类使用，你应该总是用 SqlSessionTemplate 来替换 MyBatis 默认的 DefaultSqlSession 实现。在同一应用程序中的不同类之间混杂使用可能会引起数据一致性的问题。</p><p>可以使用 SqlSessionFactory 作为构造方法的参数来创建 SqlSessionTemplate 对象。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSession&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;org.mybatis.spring.SqlSessionTemplate&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;</span>constructor<span style=color:#666>-</span>arg index<span style=color:#666>=</span><span style=color:#b44>&#34;0&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSessionFactory&#34;</span> <span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>现在，这个 bean 就可以直接注入到你的 DAO bean 中了。你需要在你的 bean 中添加一个 SqlSession 属性，就像下面这样：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserDaoImpl</span> <span style=color:#a2f;font-weight:700>implements</span> UserDao <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#a2f;font-weight:700>private</span> SqlSession sqlSession<span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setSqlSession</span><span style=color:#666>(</span>SqlSession sqlSession<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>sqlSession</span> <span style=color:#666>=</span> sqlSession<span style=color:#666>;</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#a2f;font-weight:700>public</span> User <span style=color:#00a000>getUser</span><span style=color:#666>(</span>String userId<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>return</span> sqlSession<span style=color:#666>.</span><span style=color:#b44>getMapper</span><span style=color:#666>...;</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>按下面这样，注入 SqlSessionTemplate：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;userDao&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;org.mybatis.spring.sample.dao.UserDaoImpl&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSession&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSession&#34;</span> <span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><h3 id=123整合实现一>12.3.整合实现一</h3><p>1、引入Spring配置文件beans.xml</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;?</span>xml version<span style=color:#666>=</span><span style=color:#b44>&#34;1.0&#34;</span> encoding<span style=color:#666>=</span><span style=color:#b44>&#34;UTF-8&#34;</span><span style=color:#666>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>beans xmlns<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span style=display:flex><span>      xmlns<span style=color:#666>:</span>xsi<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>      xsi<span style=color:#666>:</span>schemaLocation<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/beans
</span></span></span><span style=display:flex><span><span style=color:#b44>       http://www.springframework.org/schema/beans/spring-beans.xsd&#34;</span><span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>2、配置数据源替换mybaits的数据源</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span><span>配置数据源：数据源有非常多，可以使用第三方的，也可使使用</span>Spring<span>的</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;dataSource&#34;</span>class<span style=color:#666>=</span><span style=color:#b44>&#34;org.springframework.jdbc.datasource.DriverManagerDataSource&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;driverClassName&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;com.mysql.jdbc.Driver&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;url&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;jdbc:mysql://localhost:3306/mybatis?useSSL=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=utf8&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;username&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;root&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;password&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;123456&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>3、配置SqlSessionFactory，关联MyBatis</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span><span>配置</span>SqlSessionFactory<span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSessionFactory&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;org.mybatis.spring.SqlSessionFactoryBean&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;dataSource&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;dataSource&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;!--</span><span>关联</span>Mybatis<span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;configLocation&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;classpath:mybatis-config.xml&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;mapperLocations&#34;</span> value<span style=color:#666>=</span><span style=color:#b44>&#34;classpath:com/kuang/dao/*.xml&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>4、注册sqlSessionTemplate，关联sqlSessionFactory；</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span><span>注册</span>sqlSessionTemplate <span style=color:#666>,</span> <span>关联</span>sqlSessionFactory<span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSession&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;org.mybatis.spring.SqlSessionTemplate&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;!--</span><span>利用构造器注入</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>constructor<span style=color:#666>-</span>arg index<span style=color:#666>=</span><span style=color:#b44>&#34;0&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSessionFactory&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>5、增加Dao接口的实现类；私有化sqlSessionTemplate</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserDaoImpl</span> <span style=color:#a2f;font-weight:700>implements</span> UserMapper <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//sqlSession不用我们自己创建了，Spring来管理
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>private</span> SqlSessionTemplate sqlSession<span style=color:#666>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setSqlSession</span><span style=color:#666>(</span>SqlSessionTemplate sqlSession<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>sqlSession</span> <span style=color:#666>=</span> sqlSession<span style=color:#666>;</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> List<span style=color:#666>&lt;</span>User<span style=color:#666>&gt;</span> <span style=color:#00a000>selectUser</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       UserMapper mapper <span style=color:#666>=</span> sqlSession<span style=color:#666>.</span><span style=color:#b44>getMapper</span><span style=color:#666>(</span>UserMapper<span style=color:#666>.</span><span style=color:#b44>class</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> mapper<span style=color:#666>.</span><span style=color:#b44>selectUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>   
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>6、注册bean实现</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;userDao&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.dao.UserDaoImpl&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSession&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSession&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>7、测试</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>   <span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test2</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>       ApplicationContext context <span style=color:#666>=</span> newClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;beans.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       UserMapper mapper <span style=color:#666>=</span> <span style=color:#666>(</span>UserMapper<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;userDao&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       List<span style=color:#666>&lt;</span>User<span style=color:#666>&gt;</span> user <span style=color:#666>=</span> mapper<span style=color:#666>.</span><span style=color:#b44>selectUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>       System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>user<span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span></code></pre></div><p>结果成功输出！现在我们的Mybatis配置文件的状态！发现都可以被Spring整合！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;?</span>xml version<span style=color:#666>=</span><span style=color:#b44>&#34;1.0&#34;</span> encoding<span style=color:#666>=</span><span style=color:#b44>&#34;UTF-8&#34;</span> <span style=color:#666>?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;!</span>DOCTYPE configuration
</span></span><span style=display:flex><span>       PUBLIC <span style=color:#b44>&#34;-//mybatis.org//DTD Config 3.0//EN&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#b44>&#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>configuration<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>typeAliases<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span><span style=color:#a2f;font-weight:700>package</span> <span style=color:#00f;font-weight:700>name</span><span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>typeAliases<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>configuration<span style=color:#666>&gt;</span>
</span></span></code></pre></div><h3 id=124整合实现二>12.4.整合实现二</h3><p>mybatis-spring1.2.3版以上的才有这个 .</p><p>官方文档截图 :</p><p>dao继承Support类 , 直接利用 getSqlSession() 获得 , 然后直接注入SqlSessionFactory . 比起方式1 , 不需要管理SqlSessionTemplate , 而且对事务的支持更加友好 . 可跟踪源码查看</p><p><img src=https://bucket-typora-kw.oss-cn-beijing.aliyuncs.com/typora-image/2020061318223368.png alt=在这里插入图片描述></p><p>测试：</p><p>1、将我们上面写的UserDaoImpl修改一下</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserDaoImpl</span> <span style=color:#a2f;font-weight:700>extends</span> SqlSessionDaoSupport <span style=color:#a2f;font-weight:700>implements</span> UserMapper <span style=color:#666>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a2f;font-weight:700>public</span> List<span style=color:#666>&lt;</span>User<span style=color:#666>&gt;</span> <span style=color:#00a000>selectUser</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       UserMapper mapper <span style=color:#666>=</span> getSqlSession<span style=color:#666>().</span><span style=color:#b44>getMapper</span><span style=color:#666>(</span>UserMapper<span style=color:#666>.</span><span style=color:#b44>class</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> mapper<span style=color:#666>.</span><span style=color:#b44>selectUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>2、修改bean的配置</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;userDao&#34;</span> class<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.dao.UserDaoImpl&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSessionFactory&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;sqlSessionFactory&#34;</span> <span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>3、测试</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test2</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>   ApplicationContext context <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;beans.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   UserMapper mapper <span style=color:#666>=</span> <span style=color:#666>(</span>UserMapper<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;userDao&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   List<span style=color:#666>&lt;</span>User<span style=color:#666>&gt;</span> user <span style=color:#666>=</span> mapper<span style=color:#666>.</span><span style=color:#b44>selectUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>   System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>user<span style=color:#666>);</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p><strong>总结 : 整合到spring以后可以完全不要mybatis的配置文件，除了这些方式可以实现整合之外，我们还可以使用注解来实现，这个等我们后面学习SpringBoot的时候还会测试整合！</strong></p><h2 id=13声明式事务>13.声明式事务</h2><h3 id=131回顾事务>13.1.回顾事务</h3><ul><li>事务在项目开发过程非常重要，涉及到数据的一致性的问题，不容马虎！</li><li>事务管理是企业级应用程序开发中必备技术，用来确保数据的完整性和一致性。</li></ul><p>事务就是把一系列的动作当成一个独立的工作单元，这些动作要么全部完成，要么全部不起作用。</p><p><strong>事务四个属性ACID</strong></p><ol><li>原子性（atomicity）</li><li><ul><li>事务是原子性操作，由一系列动作组成，事务的原子性确保动作要么全部完成，要么完全不起作用</li></ul></li><li>一致性（consistency）</li><li><ul><li>一旦所有事务动作完成，事务就要被提交。数据和资源处于一种满足业务规则的一致性状态中</li></ul></li><li>隔离性（isolation）</li><li><ul><li>可能多个事务会同时处理相同的数据，因此每个事务都应该与其他事务隔离开来，防止数据损坏</li></ul></li><li>持久性（durability）</li><li><ul><li>事务一旦完成，无论系统发生什么错误，结果都不会受到影响。通常情况下，事务的结果被写到持久化存储器中</li></ul></li></ol><blockquote><h4 id=测试>测试</h4></blockquote><p>将上面的代码拷贝到一个新项目中</p><p>在之前的案例中，我们给userDao接口新增两个方法，删除和增加用户；</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#080;font-style:italic>//添加一个用户
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#0b0;font-weight:700>int</span> <span style=color:#00a000>addUser</span><span style=color:#666>(</span>User user<span style=color:#666>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic>//根据id删除用户
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#0b0;font-weight:700>int</span> <span style=color:#00a000>deleteUser</span><span style=color:#666>(</span><span style=color:#0b0;font-weight:700>int</span> id<span style=color:#666>);</span>
</span></span></code></pre></div><p>mapper文件，我们故意把 deletes 写错，测试！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;</span>insert id<span style=color:#666>=</span><span style=color:#b44>&#34;addUser&#34;</span> parameterType<span style=color:#666>=</span><span style=color:#b44>&#34;com.kuang.pojo.User&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>insert into <span style=color:#00a000>user</span> <span style=color:#666>(</span>id<span style=color:#666>,</span>name<span style=color:#666>,</span>pwd<span style=color:#666>)</span> values <span style=color:#666>(</span><span>#</span><span style=color:#666>{</span>id<span style=color:#666>},</span><span>#</span><span style=color:#666>{</span>name<span style=color:#666>},</span><span>#</span><span style=color:#666>{</span>pwd<span style=color:#666>})</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>insert<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>delete id<span style=color:#666>=</span><span style=color:#b44>&#34;deleteUser&#34;</span> parameterType<span style=color:#666>=</span><span style=color:#b44>&#34;int&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>deletes from user where id <span style=color:#666>=</span> <span>#</span><span style=color:#666>{</span>id<span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>delete<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p>编写接口的实现类，在实现类中，我们去操作一波</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>UserDaoImpl</span> <span style=color:#a2f;font-weight:700>extends</span> SqlSessionDaoSupport <span style=color:#a2f;font-weight:700>implements</span> UserMapper <span style=color:#666>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//增加一些操作
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>public</span> List<span style=color:#666>&lt;</span>User<span style=color:#666>&gt;</span> <span style=color:#00a000>selectUser</span><span style=color:#666>()</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       User user <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> User<span style=color:#666>(</span><span style=color:#666>4</span><span style=color:#666>,</span><span style=color:#b44>&#34;小明&#34;</span><span style=color:#666>,</span><span style=color:#b44>&#34;123456&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       UserMapper mapper <span style=color:#666>=</span> getSqlSession<span style=color:#666>().</span><span style=color:#b44>getMapper</span><span style=color:#666>(</span>UserMapper<span style=color:#666>.</span><span style=color:#b44>class</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       mapper<span style=color:#666>.</span><span style=color:#b44>addUser</span><span style=color:#666>(</span>user<span style=color:#666>);</span>
</span></span><span style=display:flex><span>       mapper<span style=color:#666>.</span><span style=color:#b44>deleteUser</span><span style=color:#666>(</span><span style=color:#666>4</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> mapper<span style=color:#666>.</span><span style=color:#b44>selectUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//新增
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>int</span> <span style=color:#00a000>addUser</span><span style=color:#666>(</span>User user<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       UserMapper mapper <span style=color:#666>=</span> getSqlSession<span style=color:#666>().</span><span style=color:#b44>getMapper</span><span style=color:#666>(</span>UserMapper<span style=color:#666>.</span><span style=color:#b44>class</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> mapper<span style=color:#666>.</span><span style=color:#b44>addUser</span><span style=color:#666>(</span>user<span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>   <span style=color:#080;font-style:italic>//删除
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span>   <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>int</span> <span style=color:#00a000>deleteUser</span><span style=color:#666>(</span><span style=color:#0b0;font-weight:700>int</span> id<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>       UserMapper mapper <span style=color:#666>=</span> getSqlSession<span style=color:#666>().</span><span style=color:#b44>getMapper</span><span style=color:#666>(</span>UserMapper<span style=color:#666>.</span><span style=color:#b44>class</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>       <span style=color:#a2f;font-weight:700>return</span> mapper<span style=color:#666>.</span><span style=color:#b44>deleteUser</span><span style=color:#666>(</span>id<span style=color:#666>);</span>
</span></span><span style=display:flex><span>  <span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>测试</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test2</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>   ApplicationContext context <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;beans.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   UserMapper mapper <span style=color:#666>=</span> <span style=color:#666>(</span>UserMapper<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;userDao&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   List<span style=color:#666>&lt;</span>User<span style=color:#666>&gt;</span> user <span style=color:#666>=</span> mapper<span style=color:#666>.</span><span style=color:#b44>selectUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>   System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>user<span style=color:#666>);</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>报错：sql异常，delete写错了</p><p>结果 ：插入成功！</p><p>没有进行事务的管理；我们想让他们都成功才成功，有一个失败，就都失败，我们就应该需要<strong>事务！</strong></p><p>以前我们都需要自己手动管理事务，十分麻烦！</p><p>但是Spring给我们提供了事务管理，我们只需要配置即可；</p><h3 id=132spring中的事务管理>13.2.Spring中的事务管理</h3><p>Spring在不同的事务管理API之上定义了一个抽象层，使得开发人员不必了解底层的事务管理API就可以使用Spring的事务管理机制。Spring支持编程式事务管理和声明式的事务管理。</p><p><strong>编程式事务管理</strong></p><ul><li>将事务管理代码嵌到业务方法中来控制事务的提交和回滚</li><li>缺点：必须在每个事务操作业务逻辑中包含额外的事务管理代码</li></ul><p><strong>声明式事务管理</strong></p><ul><li>一般情况下比编程式事务好用。</li><li>将事务管理代码从业务方法中分离出来，以声明的方式来实现事务管理。</li><li>将事务管理作为横切关注点，通过aop方法模块化。Spring中通过Spring AOP框架支持声明式事务管理。</li></ul><p><strong>使用Spring管理事务，注意头文件的约束导入 : tx</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a0a000>xmlns:</span>tx<span style=color:#666>=</span><span style=color:#b44>&#34;http://www.springframework.org/schema/tx&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a0a000>
</span></span></span><span style=display:flex><span><span style=color:#a0a000>http:</span><span style=color:#080;font-style:italic>//www.springframework.org/schema/tx
</span></span></span><span style=display:flex><span><span style=color:#080;font-style:italic></span><span style=color:#a0a000>http:</span><span style=color:#080;font-style:italic>//www.springframework.org/schema/tx/spring-tx.xsd&#34;&gt;
</span></span></span></code></pre></div><p><strong>事务管理器</strong></p><ul><li>无论使用Spring的哪种事务管理策略（编程式或者声明式）事务管理器都是必须的。</li><li>就是 Spring的核心事务管理抽象，管理封装了一组独立于技术的方法。</li></ul><p><strong>JDBC事务</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;</span>bean id<span style=color:#666>=</span><span style=color:#b44>&#34;transactionManager&#34;</span>class<span style=color:#666>=</span><span style=color:#b44>&#34;org.springframework.jdbc.datasource.DataSourceTransactionManager&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>property name<span style=color:#666>=</span><span style=color:#b44>&#34;dataSource&#34;</span> ref<span style=color:#666>=</span><span style=color:#b44>&#34;dataSource&#34;</span> <span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>bean<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p><strong>配置好事务管理器后我们需要去配置事务的通知</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span><span>配置事务通知</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>tx<span style=color:#666>:</span>advice id<span style=color:#666>=</span><span style=color:#b44>&#34;txAdvice&#34;</span> transaction<span style=color:#666>-</span>manager<span style=color:#666>=</span><span style=color:#b44>&#34;transactionManager&#34;</span><span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>tx<span style=color:#666>:</span>attributes<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;!--</span><span>配置哪些方法使用什么样的事务</span><span style=color:#666>,</span><span>配置事务的传播特性</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>tx<span style=color:#666>:</span>method name<span style=color:#666>=</span><span style=color:#b44>&#34;add&#34;</span> propagation<span style=color:#666>=</span><span style=color:#b44>&#34;REQUIRED&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>tx<span style=color:#666>:</span>method name<span style=color:#666>=</span><span style=color:#b44>&#34;delete&#34;</span> propagation<span style=color:#666>=</span><span style=color:#b44>&#34;REQUIRED&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>tx<span style=color:#666>:</span>method name<span style=color:#666>=</span><span style=color:#b44>&#34;update&#34;</span> propagation<span style=color:#666>=</span><span style=color:#b44>&#34;REQUIRED&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>tx<span style=color:#666>:</span>method name<span style=color:#666>=</span><span style=color:#b44>&#34;search*&#34;</span> propagation<span style=color:#666>=</span><span style=color:#b44>&#34;REQUIRED&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>tx<span style=color:#666>:</span>method name<span style=color:#666>=</span><span style=color:#b44>&#34;get&#34;</span> read<span style=color:#666>-</span>only<span style=color:#666>=</span><span style=color:#b44>&#34;true&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#666>&lt;</span>tx<span style=color:#666>:</span>method name<span style=color:#666>=</span><span style=color:#b44>&#34;*&#34;</span> propagation<span style=color:#666>=</span><span style=color:#b44>&#34;REQUIRED&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;/</span>tx<span style=color:#666>:</span>attributes<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>tx<span style=color:#666>:</span>advice<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p><strong>spring事务传播特性：</strong></p><p>事务传播行为就是多个事务方法相互调用时，事务如何在这些方法间传播。spring支持7种事务传播行为：</p><ul><li>propagation_requierd：如果当前没有事务，就新建一个事务，如果已存在一个事务中，加入到这个事务中，这是最常见的选择。</li><li>propagation_supports：支持当前事务，如果没有当前事务，就以非事务方法执行。</li><li>propagation_mandatory：使用当前事务，如果没有当前事务，就抛出异常。</li><li>propagation_required_new：新建事务，如果当前存在事务，把当前事务挂起。</li><li>propagation_not_supported：以非事务方式执行操作，如果当前存在事务，就把当前事务挂起。</li><li>propagation_never：以非事务方式执行操作，如果当前事务存在则抛出异常。</li><li>propagation_nested：如果当前存在事务，则在嵌套事务内执行。如果当前没有事务，则执行与propagation_required类似的操作</li></ul><p>Spring 默认的事务传播行为是 PROPAGATION_REQUIRED，它适合于绝大多数的情况。</p><p>假设 ServiveX#methodX() 都工作在事务环境下（即都被 Spring 事务增强了），假设程序中存在如下的调用链：Service1#method1()->Service2#method2()->Service3#method3()，那么这 3 个服务类的 3 个方法通过 Spring 的事务传播机制都工作在同一个事务中。</p><p>就好比，我们刚才的几个方法存在调用，所以会被放在一组事务当中！</p><p><strong>配置AOP</strong></p><p>导入aop的头文件！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#666>&lt;!--</span><span>配置</span>aop<span>织入事务</span><span style=color:#666>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>config<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>pointcut id<span style=color:#666>=</span><span style=color:#b44>&#34;txPointcut&#34;</span> expression<span style=color:#666>=</span><span style=color:#b44>&#34;execution(* com.kuang.dao.*.*(..))&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#666>&lt;</span>aop<span style=color:#666>:</span>advisor advice<span style=color:#666>-</span>ref<span style=color:#666>=</span><span style=color:#b44>&#34;txAdvice&#34;</span> pointcut<span style=color:#666>-</span>ref<span style=color:#666>=</span><span style=color:#b44>&#34;txPointcut&#34;</span><span style=color:#666>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#666>&lt;/</span>aop<span style=color:#666>:</span>config<span style=color:#666>&gt;</span>
</span></span></code></pre></div><p><strong>进行测试</strong></p><p>删掉刚才插入的数据，再次测试！</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a2f>@Test</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>test2</span><span style=color:#666>(){</span>
</span></span><span style=display:flex><span>   ApplicationContext context <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ClassPathXmlApplicationContext<span style=color:#666>(</span><span style=color:#b44>&#34;beans.xml&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   UserMapper mapper <span style=color:#666>=</span> <span style=color:#666>(</span>UserMapper<span style=color:#666>)</span> context<span style=color:#666>.</span><span style=color:#b44>getBean</span><span style=color:#666>(</span><span style=color:#b44>&#34;userDao&#34;</span><span style=color:#666>);</span>
</span></span><span style=display:flex><span>   List<span style=color:#666>&lt;</span>User<span style=color:#666>&gt;</span> user <span style=color:#666>=</span> mapper<span style=color:#666>.</span><span style=color:#b44>selectUser</span><span style=color:#666>();</span>
</span></span><span style=display:flex><span>   System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>user<span style=color:#666>);</span>
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div></div><footer class=post-footer><div class=post-tags><a href=/tags/spring rel=tag title=Spring>#Spring#</a>
<a href=/tags/java rel=tag title=java>#java#</a>
<a href=/tags/learning rel=tag title=Learning>#Learning#</a></div><div class=addthis_inline_share_toolbox></div><div class=post-nav><div class=article-copyright><div class=article-copyright-img><img src=/img/qq_qrcode.png width=129px height=129px><div style=text-align:center>QQ扫一扫交流</div></div><div class=article-copyright-info><p><span>标题：</span>Spring基础汇总</p><p><span>链接：</span>https://codingroam.github.io/post/spring%E5%9F%BA%E7%A1%80%E6%B1%87%E6%80%BB/</p><p><span>作者：</span>roam</p><p><span>声明： </span>本博客文章除特别声明外，均采用 <a href=https://creativecommons.org/licenses/by-nc-sa/3.0/ target=_blank style=text-decoration:underline>CC BY-NC-SA 3.0</a>许可协议，转载请注明出处！</p></div></div><div class=clear></div></div><div class=reward-qr-info><div>创作实属不易，如有帮助，那就打赏博主些许茶钱吧 ^_^</div><button id=rewardButton disable=enable onclick='var qr=document.getElementById("QR");qr.style.display==="none"?qr.style.display="block":qr.style.display="none"'>
<span>赏</span></button><div id=QR style=display:none><div id=wechat style=display:inline-block><img id=wechat_qr src=/img/wechat-pay.png alt="WeChat Pay"><p>微信打赏</p></div><div id=alipay style=display:inline-block><img id=alipay_qr src=/img/ali-pay.png alt=Alipay><p>支付宝打赏</p></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=https://codingroam.github.io/post/git%E8%AE%BE%E7%BD%AEssh%E6%96%B9%E5%BC%8F/ rel=next title=Git设置SSH方式><i class="fa fa-chevron-left"></i> Git设置SSH方式</a></div><div class="post-nav-prev post-nav-item"><a href=https://codingroam.github.io/post/%E7%B2%BE%E9%80%9Agit/ rel=prev title=精通Git>精通Git
<i class="fa fa-chevron-right"></i></a></div></div><div id=wcomments></div></footer></article></section></div></div><div class=sidebar-toggle><div class=sidebar-toggle-line-wrap><span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id=sidebar class=sidebar><div class=sidebar-inner><section class="site-overview sidebar-panel sidebar-panel-active"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image src=/img/avatar.png alt=roam><p class=site-author-name itemprop=name>roam</p><p class="site-description motion-element" itemprop=description>以为打得赢我啊你</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href=/post/><span class=site-state-item-count>61</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>22</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>43</span>
<span class=site-state-item-name>标签</span></a></div></nav><div class="links-of-author motion-element"><span class=links-of-author-item><a href=https://github.com/wk123456/ target=_blank title=GitHub><i class="fa fa-fw fa-github"></i>
GitHub</a></span>
<span class=links-of-author-item><a href=https://www.zhihu.com/ target=_blank title=知乎><i class="fa fa-fw fa-globe"></i>
知乎</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class=links-of-blogroll-title><i class="fa fa-fw fa-globe"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://nutzam.com/ title=Nutz target=_blank>Nutz</a></li><li class=links-of-blogroll-item><a href=https://jfinal.com/ title=JFinal target=_blank>JFinal</a></li><li class=links-of-blogroll-item><a href=http://wendal.net/ title=Wendal target=_blank>Wendal</a></li><li class=links-of-blogroll-item><a href=https://www.liaoxuefeng.com/ title=廖雪峰 target=_blank>廖雪峰</a></li></ul></div><div class="tagcloud-of-blogroll motion-element tagcloud-of-blogroll-inline"><div class=tagcloud-of-blogroll-title><i class="fa fa-fw fa-tags"></i>
标签云</div><ul class=tagcloud-of-blogroll-list><li class=tagcloud-of-blogroll-item><a href=/tags/learning>Learning
<sup>31</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/mysql>Mysql
<sup>10</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/java>Java
<sup>9</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6>中间件
<sup>9</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/linux>Linux
<sup>8</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/problem-solving>Problem solving
<sup>7</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/docker>Docker
<sup>6</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/redis>Redis
<sup>6</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/hands-on>Hands on
<sup>5</sup></a></li><li class=tagcloud-of-blogroll-item><a href=/tags/git>Git
<sup>4</sup></a></li></ul></div></section></div></aside></div></main><footer id=footer class=footer><div class=footer-inner><div class=copyright><span class=copyright-year>&copy; 2010 - 2023</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=copyright-author>想学啊你</span></div><div class=powered-info><span class=powered-by>Powered by - <a class=powered-link href=//gohugo.io target=_blank title=hugo>Hugo v0.115.4</a></span>
<span class=separator-line>/</span>
<span class=theme-info>Theme by - <a class=powered-link href=//github.com/elkan1788/hugo-theme-next target=_blank>NexT</a></span></div><div class=vistor-info><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<span class=site-uv><i class="fa fa-user"></i>
<span class=busuanzi-value id=busuanzi_value_site_uv></span></span>
<span class=separator-line>/</span>
<span class=site-pv><i class="fa fa-eye"></i>
<span class=busuanzi-value id=busuanzi_value_site_pv></span></span></div><div class=license-info><span class=storage-info>Storage by
<a href=https://gitee.com/ style=font-weight:700 target=_blank>Gitee 仓库</a></span>
<span class=separator-line>/</span>
<span class=license-num><a href=http://beian.miit.gov.cn target=_blank>粤 ICP 备 18047355 号</a></span></div></div></footer><div class=back-to-top><i class="fa fa-arrow-up"></i>
<span id=scrollpercent><span>0</span>%</span></div></div><script type=text/javascript src=//unpkg.com/jquery@2.1.4/dist/jquery.min.js></script>
<script type=text/javascript src=https://codingroam.github.io/js/search.js></script>
<script type=text/javascript src=https://codingroam.github.io/js/affix.js></script>
<script type=text/javascript>function detectIE(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/"),s=e.indexOf("Edge/");return t>0||n>0||s>0?-1:1}function getCntViewHeight(){var t=$("#content").height(),e=$(window).height(),n=t>e?t-e:$(document).height()-e;return n}function getScrollbarWidth(){var e=$("<div />").addClass("scrollbar-measure").prependTo("body"),t=e[0],n=t.offsetWidth-t.clientWidth;return e.remove(),n}function registerBackTop(){var t=50,e=$(".back-to-top");$(window).on("scroll",function(){e.toggleClass("back-to-top-on",window.pageYOffset>t);var s=$(window).scrollTop(),o=getCntViewHeight(),i=s/o,n=Math.round(i*100),a=n>100?100:n;$("#scrollpercent>span").html(a)}),e.on("click",function(){$("html,body").animate({scrollTop:0,screenLeft:0},800)})}function initScrollSpy(){var e=".post-toc",s=$(e),t=".active-current";s.on("activate.bs.scrollspy",function(){var t=$(e+" .active").last();n(),t.addClass("active-current")}).on("clear.bs.scrollspy",n),$("body").scrollspy({target:e});function n(){$(e+" "+t).removeClass(t.substring(1))}}function initAffix(){var e=$(".header-inner").height(),t=parseInt($(".footer").outerHeight(!0),10),n=e+10;$(".sidebar-inner").affix({offset:{top:n,bottom:t}})}function initTOCDimension(){$(window).on("resize",function(){e&&clearTimeout(e),e=setTimeout(function(){var e=document.body.clientHeight-100;updateTOCHeight(e)},0)}),updateTOCHeight(document.body.clientHeight-100);var e,t=getScrollbarWidth();$(".post-toc").css("width","calc(100% + "+t+"px)")}function updateTOCHeight(e){e=e||"auto",$(".post-toc").css("max-height",e)}$(function(){var e,t,n,s,o=$(".header-inner").height()+10;$("#sidebar").css({"margin-top":o}).show(),t=parseInt($("#sidebar").css("margin-top")),n=parseInt($(".sidebar-inner").css("height")),e=t+n,s=$(".content-wrap").height(),s<e&&$(".content-wrap").css("min-height",e),$(".site-nav-toggle").on("click",function(){var e=$(".site-nav"),o=$(".toggle"),t="site-nav-on",i="toggle-close",n=e.hasClass(t),a=n?"slideUp":"slideDown",s=n?"removeClass":"addClass";e.stop()[a]("normal",function(){e[s](t),o[s](i)})}),registerBackTop(),initAffix(),initTOCDimension(),$(".sidebar-nav-toc").click(function(){$(this).addClass("sidebar-nav-active"),$(this).next().removeClass("sidebar-nav-active"),$("."+$(this).next().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)}),$(".sidebar-nav-overview").click(function(){$(this).addClass("sidebar-nav-active"),$(this).prev().removeClass("sidebar-nav-active"),$("."+$(this).prev().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)})})</script><script src=//unpkg.com/imageviewer@1.1.0/dist/viewer.min.js></script>
<script type=text/javascript>$(function(){$(".post-body").viewer()})</script><script type=text/javascript>const locale={placeholder:"欢迎留下您的宝贵建议，请填写您的昵称和邮箱便于后续交流. ^_^"};$(function(){detectIE()>0?$.getScript(document.location.protocol+"//unpkg.com/@waline/client@1.6.0/dist/Waline.min.js",function(){new Waline({el:"#wcomments",visitor:!0,emoji:[],wordLimit:"200",uploadImage:!1,locale,requiredMeta:["nick","mail"],serverURL:"Your WalineSerURL",lang:"zh-cn"})}):$("#wcomments").html("抱歉，Waline插件不支持IE或Edge，建议使用Chrome浏览器。")})</script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=Your%20AddthisId"></script>
<script>(function(){var t,e=document.createElement("script"),n=window.location.protocol.split(":")[0];n==="https"?e.src="https://zz.bdstatic.com/linksubmit/push.js":e.src="http://push.zhanzhang.baidu.com/push.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script></body></html>